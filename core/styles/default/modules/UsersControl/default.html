<table class="grid-tb tablesorter" id="users-list">
	<thead>
 		<tr>
  			<th>ID</th>
		    <th>{m('Login')}</th>
		    <th>{m('Email')}</th>
			<th>{m('Groups')}</th>
			<th colspan="2">{m('Visits')}</th>
  		</tr>
	</thead>
	<tbody>
		<!-- BEGIN USER -->
  		<tr>
  			<td>{uid}</td>
    		<td><a href="#{uid}" class="user-profile" title="{m('User profile')}">{login}</a></td>
    		<td>{email} </td>
			<td>{groups} </td>
			<td>{visits}/{atime}</td>
			<td>
				<!-- BEGIN ADMIN -->
				<ul class="adm-icons">
					<li><a href="{URL}edit/{uid}/"    class="icons user-edit"  title="{m('Edit')}"></a></li>
					<li><a href="{URL}ugroups/{uid}/" class="icons user-group" title="{m('Groups')}"></a></li>
					<li><a href="{URL}passwd/{uid}/"  class="icons lock"       title="{m('Password')}"></a></li>
					<li><a href="{URL}delete/{uid}/"  class="icons delete"     title="{m('Delete)}" onClick="return confirm('{m('Do you realy want to delete user')} `{login}`?');"></a></li>
				</ul>
				<!-- END ADMIN -->
			</td>
  		</tr>
		<!-- END USER -->
	</tbody>
</table>
{PAGER}
<script type="text/javascript" charset="utf-8">
	$().ready(function() { 
		$("#users-list").tablesorter(); 
		
		$('a.user-profile').click(function(e) {
			e.preventDefault();
			var spinner = $('<div class="spinner">{m('Please wait')}...</div>'),
				d = $('<div/>')
					.append(spinner)
					.dialog({
						title   : "{m('User profile')}",
						width   : 500,
						close   : function() { $(this).dialog('destroy'); },
						buttons : { OK : function() { $(this).dialog('close'); } }
					}),
				cont, l;
				
			$.ajax({
				url      : "{BASE_URL}__profile__/get/"+$(this).attr('href').replace('#', '')+"/",
				dataType : 'json',
				error    : function() { 
					spinner.remove(); 
					d.append("{m('Data transfer error')}"); },
				success : function(data) {
					spinner.remove(); 
					if (data.error) {
						cont = data.error;
					} else {
						cont = $('<table class="grid-tb"/>');
						l = data.length;
						while (l--) {
							cont.prepend('<tr><td>'+data[l].label+'</td><td>'+data[l].value+'</td></tr>');
						}
					}
					d.append(cont);
					
				}
			});
		})
		
	});
</script>