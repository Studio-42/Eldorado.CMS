function eli18n(a){this.textdomain=function(b){return this.messages[b]?this._domain=b:this._domain};a&&a.messages&&this.load(a.messages);a&&a.textdomain&&this.textdomain(a.textdomain)}eli18n.prototype=new function(){this.messages={};this._domain="";this.load=function(c){if(typeof(c)=="object"){for(var f in c){var b=c[f];if(typeof(b)=="object"){if(!this.messages[f]){this.messages[f]={}}for(var a in b){if(typeof(b[a])=="string"){this.messages[f][a]=b[a]}}}}}return this};this.translate=function(b,a){var a=a&&this.messages[a]?a:this._domain;return this.messages[a]&&this.messages[a][b]?this.messages[a][b]:b};this.format=function(f,b,c){f=this.translate(f,c);if(typeof(b)=="object"){for(var a in b){f=f.replace("%"+a,this.translate(b[a],c))}}return f}};function elDialogForm(c){var a=this;var b={"class":"el-dialogform",submit:function(f,g){window.console&&window.console.log&&window.console.log("submit called");g.close()},form:{action:window.location.href,method:"post"},ajaxForm:null,validate:null,spinner:"Loading",tabs:{active:0},tabPrefix:"el-df-tab-",dialog:{title:"dialog",autoOpen:false,modal:true,resizable:false,buttons:{Cancel:function(){a.close()},Ok:function(){a.form.trigger("submit")}}}};this.opts=jQuery.extend(true,b,c,{dialog:{autoOpen:false,close:function(){a.close()}}});if(c&&c.dialog&&c.dialog.buttons&&typeof(c.dialog.buttons)=="object"){this.opts.dialog.buttons=c.dialog.buttons}this.ul=null;this.tabs={};this._table=null;this.dialog=jQuery("<div />").addClass(this.opts["class"]).dialog(this.opts.dialog);this.message=jQuery('<div class="el-dialogform-message rounded-5" />').hide().appendTo(this.dialog);this.error=jQuery('<div class="el-dialogform-error rounded-5" />').hide().appendTo(this.dialog);this.spinner=jQuery('<div class="spinner" />').hide().appendTo(this.dialog);this.content=jQuery('<div class="el-dialogform-content" />').appendTo(this.dialog);this.form=jQuery("<form />").attr(this.opts.form).appendTo(this.content);if(this.opts.submit){this.form.bind("submit",function(d){a.opts.submit(d,a)})}if(this.opts.ajaxForm&&jQuery.fn.ajaxForm){this.form.ajaxForm(this.opts.ajaxForm)}if(this.opts.validate){this.form.validate(this.opts.validate)}this.option=function(d,f){return this.dialog.dialog("option",d,f)};this.showError=function(d,f){this.hideMessage();this.hideSpinner();this.error.html(d).show();f&&this.content.hide();return this};this.hideError=function(){this.error.text("").hide();this.content.show();return this};this.showSpinner=function(d){this.error.hide();this.message.hide();this.content.hide();this.spinner.text(d||this.opts.spinner).show();this.option("buttons",{});return this};this.hideSpinner=function(){this.content.show();this.spinner.hide();return this};this.showMessage=function(d,f){this.hideError();this.hideSpinner();this.message.html(d||"").show();f&&this.content.hide();return this};this.hideMessage=function(){this.message.hide();this.content.show();return this};this.tab=function(f,d){f=this.opts.tabPrefix+f;if(!this.ul){this.ul=jQuery("<ul />").prependTo(this.form)}jQuery("<li />").append(jQuery("<a />").attr("href","#"+f).html(d)).appendTo(this.ul);this.tabs[f]={tab:jQuery("<div />").attr("id",f).addClass("tab").appendTo(this.form),table:null};return this};this.table=function(d){d=d&&d.indexOf(this.opts.tabPrefix)==-1?this.opts.tabPrefix+d:d;if(d&&this.tabs&&this.tabs[d]){this.tabs[d].table=jQuery("<table />").appendTo(this.tabs[d].tab)}else{this._table=jQuery("<table />").appendTo(this.form)}return this};this.append=function(h,j,f){j=j?"el-df-tab-"+j:"";if(!h){return this}if(j&&this.tabs[j]){if(f){!this.tabs[j].table&&this.table(j);var g=jQuery("<tr />").appendTo(this.tabs[j].table);if(!$.isArray(h)){g.append(jQuery("<td />").append(h))}else{for(var d=0;d<h.length;d++){g.append(jQuery("<td />").append(h[d]))}}}else{if(!jQuery.isArray(h)){this.tabs[j].tab.append(h)}else{for(var d=0;d<h.length;d++){this.tabs[j].tab.append(h[d])}}}}else{if(!f){if(!jQuery.isArray(h)){this.form.append(h)}else{for(var d=0;d<h.length;d++){this.form.append(h[d])}}}else{if(!this._table){this.table()}var g=jQuery("<tr />").appendTo(this._table);if(!jQuery.isArray(h)){g.append(jQuery("<td />").append(h))}else{for(var d=0;d<h.length;d++){g.append(jQuery("<td />").append(h[d]))}}}}return this};this.separator=function(d){d="el-df-tab-"+d;if(this.tabs&&this.tabs[d]){this.tabs[d].tab.append(jQuery("<div />").addClass("separator"));this.tabs[d].table&&this.table(d)}else{this.form.append(jQuery("<div />").addClass("separator"))}return this};this.open=function(){this.ul&&this.form.tabs(this.opts.tabs);this.form.find(":text").keyup(function(d){if(d.keyCode==13){a.form.submit()}});this.dialog.attr("unselectable","on").dialog("open");this.form.find(":text").eq(0).focus();return this};this.close=function(){this.dialog.dialog("destroy").remove()}}(function(a){a.fn.elColorPicker=function(g){var b=this;var d=a.extend({},a.fn.elColorPicker.defaults,g);this.hidden=a('<input type="hidden" />').attr("name",d.name).val(d.color||"").appendTo(this);this.palette=null;this.preview=null;this.input=null;function c(h){b.val(h);d.change&&d.change(b.val());b.palette.slideUp()}function f(){b.palette=a("<div />").addClass(d.paletteClass+" rounded-3");for(var h=0;h<d.colors.length;h++){a("<div />").addClass("color").css("background-color",d.colors[h]).attr({title:d.colors[h],unselectable:"on"}).appendTo(b.palette).mouseenter(function(){var j=a(this).attr("title");b.input.val(j);b.preview.css("background-color",j)}).click(function(j){j.stopPropagation();c(a(this).attr("title"))})}b.input=a('<input type="text" />').addClass("rounded-3").attr("size",8).click(function(j){j.stopPropagation()}).keydown(function(o){if(o.ctrlKey||o.metaKey){return true}var j=o.keyCode;if(j==27){return b.mouseleave()}if(j!=8&&j!=13&&j!=46&&j!=37&&j!=39&&(j<48||j>57)&&(j<65||j>70)){return false}var p=a(this).val();if(p.length==7||p.length==0){if(j==13){o.stopPropagation();o.preventDefault();c(p);b.palette.slideUp()}if(o.keyCode!=8&&o.keyCode!=46&&j!=37&&j!=39){return false}}}).keyup(function(j){var k=a(this).val();k.length==7&&/^#[0-9abcdef]{6}$/i.test(k)&&b.val(k)});b.preview=a("<div />").addClass("preview rounded-3").click(function(j){j.stopPropagation();c(b.input.val())});b.palette.append(a("<div />").addClass("clearfix")).append(a("<div />").addClass("panel").append(b.input).append(b.preview));if(d.palettePosition=="outer"){b.palette.hide().appendTo(b.parents("body").eq(0)).mouseleave(function(){a(this).slideUp();b.val(b.val())});b.mouseleave(function(j){if(j.relatedTarget!=b.palette.get(0)){b.palette.slideUp();b.val(b.val())}})}else{b.append(b.palette.hide()).mouseleave(function(j){b.palette.slideUp();b.val(b.val())})}b.val(b.val())}this.empty().addClass(d["class"]+" rounded-3").css({position:"relative","background-color":d.color||""}).click(function(k){if(!b.hasClass("disabled")){!b.palette&&f();if(d.palettePosition=="outer"&&b.palette.css("display")=="none"){var p=a(this).offset();var j=b.palette.width();var h=b.parents("body").width()-p.left>=j?p.left:p.left+a(this).outerWidth()-j;b.palette.css({left:h+"px",top:p.top+a(this).height()+1+"px"})}b.palette.slideToggle()}});this.val=function(h){if(!h&&h!==""){return this.hidden.val()}else{this.hidden.val(h);if(d.update){d.update(this.hidden.val())}else{this.css("background-color",h)}if(b.palette){b.preview.css("background-color",h);b.input.val(h)}}return this};return this};a.fn.elColorPicker.defaults={"class":"el-colorpicker",paletteClass:"el-palette",palettePosition:"inner",name:"color",color:"",update:null,change:function(b){window.console&&window.console.log&&window.console.log(b)},colors:["#ffffff","#cccccc","#999999","#666666","#333333","#000000","#ffcccc","#cc9999","#996666","#663333","#330000","#ff9999","#cc6666","#cc3333","#993333","#660000","#ff6666","#ff3333","#ff0000","#cc0000","#990000","#ff9966","#ff6633","#ff3300","#cc3300","#993300","#ffcc99","#cc9966","#cc6633","#996633","#663300","#ff9933","#ff6600","#ff9900","#cc6600","#cc9933","#ffcc66","#ffcc33","#ffcc00","#cc9900","#996600","#ffffcc","#cccc99","#999966","#666633","#333300","#ffff99","#cccc66","#cccc33","#999933","#666600","#ffff66","#ffff33","#ffff00","#cccc00","#999900","#ccff66","#ccff33","#ccff00","#99cc00","#669900","#ccff99","#99cc66","#99cc33","#669933","#336600","#99ff33","#99ff00","#66ff00","#66cc00","#66cc33","#99ff66","#66ff33","#33ff00","#33cc00","#339900","#ccffcc","#99cc99","#669966","#336633","#003300","#99ff99","#66cc66","#33cc33","#339933","#006600","#66ff66","#33ff33","#00ff00","#00cc00","#009900","#66ff99","#33ff66","#00ff33","#00cc33","#009933","#99ffcc","#66cc99","#33cc66","#339966","#006633","#33ff99","#00ff66","#00ff99","#00cc66","#33cc99","#66ffcc","#33ffcc","#00ffcc","#00cc99","#009966","#ccffff","#99cccc","#669999","#336666","#003333","#99ffff","#66cccc","#33cccc","#339999","#006666","#66cccc","#33ffff","#00ffff","#00cccc","#009999","#66ccff","#33ccff","#00ccff","#0099cc","#006699","#99ccff","#6699cc","#3399cc","#336699","#003366","#3399ff","#0099ff","#0066ff","#066ccc","#3366cc","#6699ff","#3366ff","#0033ff","#0033cc","#003399","#ccccff","#9999cc","#666699","#333366","#000033","#9999ff","#6666cc","#3333cc","#333399","#000066","#6666ff","#3333ff","#0000ff","#0000cc","#009999","#9966ff","#6633ff","#3300ff","#3300cc","#330099","#cc99ff","#9966cc","#6633cc","#663399","#330066","#9933ff","#6600ff","#9900ff","#6600cc","#9933cc","#cc66ff","#cc33ff","#cc00ff","#9900cc","#660099","#ffccff","#cc99cc","#996699","#663366","#330033","#ff99ff","#cc66cc","#cc33cc","#993399","#660066","#ff66ff","#ff33ff","#ff00ff","#cc00cc","#990099","#ff66cc","#ff33cc","#ff00cc","#cc0099","#990066","#ff99cc","#cc6699","#cc3399","#993366","#660033","#ff3399","#ff0099","#ff0066","#cc0066","#cc3366","#ff6699","#ff3366","#ff0033","#cc0033","#990033"]}})(jQuery);(function(a){a.fn.elBorderSelect=function(g){var j=this;var p=this.eq(0);var b=a.extend({},a.fn.elBorderSelect.defaults,g);var d=a('<input type="text" />').attr({name:b.name+"[width]",size:3}).css("text-align","right").change(function(){j.change()});var h=a("<div />").css("position","relative").elColorPicker({"class":"el-colorpicker ui-icon ui-icon-pencil",name:b.name+"[color]",palettePosition:"outer",change:function(){j.change()}});var c=a("<div />").elSelect({tpl:'<div style="border-bottom:4px %val #000;width:100%;margin:7px 0"> </div>',tpls:{"":"%label"},maxHeight:b.styleHeight||null,select:function(){j.change()},src:{"":"none",solid:"solid",dashed:"dashed",dotted:"dotted","double":"double",groove:"groove",ridge:"ridge",inset:"inset",outset:"outset"}});p.empty().addClass(b["class"]).attr("name",b.name||"").append(a("<table />").attr("cellspacing",0).append(a("<tr />").append(a("<td />").append(d).append(" px")).append(a("<td />").append(c)).append(a("<td />").append(h))));function f(r){function q(t){hexDigits=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return !t?"00":hexDigits[(t-t%16)/16]+hexDigits[t%16]}var o=r&&r.length?r.match(/\(([0-9]{1,3}),\s*([0-9]{1,3}),\s*([0-9]{1,3})\)/):"";return o?"#"+q(o[1])+q(o[2])+q(o[3]):""}function k(q){window.console.log(q);var o=(q||"").match(/([0-9]+\.?[0-9]*)\s*(px|pt|em|%)/);if(o){q=o[1];unit=o[2]}else{return 0}if(q[0]=="."){q="0"+q}q=parseFloat(q);if(isNaN(q)){return""}var r=parseInt(a(document.body).css("font-size"))||16;switch(unit){case"em":return parseInt(q*r);case"pt":return parseInt(q*r/12);case"%":return parseInt(q*r/100)}return q}this.change=function(){b.change&&b.change(this.val())};this.val=function(t){if(!t&&t!==""){var r=parseInt(d.val());return{width:!isNaN(r)?r+"px":"",style:c.val(),color:h.val()}}else{var q,r,u,x,o="";if(t.nodeName||t.css){if(!t.css){t=a(t)}var o=t.css("border");if((o=t.css("border"))){r=u=x=o}else{r=t.css("border-width");u=t.css("border-style");x=t.css("border-color")}}else{r=t.width||"";u=t.style||"";x=t.color||""}d.val(k(r));var q=u?u.match(/(solid|dashed|dotted|double|groove|ridge|inset|outset)/i):"";c.val(q?q[1]:"");h.val(f(x));return this}};this.val(b.value);return this};a.fn.elBorderSelect.defaults={name:"el-borderselect","class":"el-borderselect",value:{},change:null}})(jQuery);(function(a){a.fn.elPaddingInput=function(f){var c=this;var d=a.extend({},a.fn.elPaddingInput.defaults,{name:this.attr("name")},f);this.regexps={main:new RegExp(d.type=="padding"?'paddings*:s*([^;"]+)':'margins*:s*([^;"]+)',"im"),left:new RegExp(d.type=="padding"?'padding-lefts*:s*([^;"]+)':'margin-lefts*:s*([^;"]+)',"im"),top:new RegExp(d.type=="padding"?'padding-tops*:s*([^;"]+)':'margin-tops*:s*([^;"]+)',"im"),right:new RegExp(d.type=="padding"?'padding-rights*:s*([^;"]+)':'margin-rights*:s*([^;"]+)',"im"),bottom:new RegExp(d.type=="padding"?'padding-bottoms*:s*([^;"]+)':'margin-bottoms*:s*([^;"]+)',"im")};a.each(["left","top","right","bottom"],function(){c[this]=a('<input type="text" />').attr("size",3).css("text-align","right").bind("change",function(){a(this).val(b(a(this).val()));g()}).attr("name",d.name+"["+this+"]")});a.each(["uleft","utop","uright","ubottom"],function(){c[this]=a("<select />").append('<option value="px">px</option>').append('<option value="em">em</option>').append('<option value="pt">pt</option>').bind("change",function(){g()}).attr("name",d.name+"["+this+"]");if(d.percents){c[this].append('<option value="%">%</option>')}});this.empty().addClass(d["class"]).append(this.left).append(this.uleft).append(" x ").append(this.top).append(this.utop).append(" x ").append(this.right).append(this.uright).append(" x ").append(this.bottom).append(this.ubottom);this.val=function(x){if(!x&&x!==""){var p=b(this.left.val());var z=b(this.top.val());var h=b(this.right.val());var w=b(this.bottom.val());var u={left:p=="auto"||p==0?p:(p!==""?p+this.uleft.val():""),top:z=="auto"||z==0?z:(z!==""?z+this.utop.val():""),right:h=="auto"||h==0?h:(h!==""?h+this.uright.val():""),bottom:w=="auto"||w==0?w:(w!==""?w+this.ubottom.val():""),css:""};if(u.left!==""&&u.right!==""&&u.top!==""&&u.bottom!==""){if(u.left==u.right&&u.top==u.bottom){u.css=u.top+" "+u.left}else{u.css=u.top+" "+u.right+" "+u.bottom+" "+u.left}}return u}else{if(x.nodeName||x.css){if(!x.css){x=a(x)}var k={left:"",top:"",right:"",bottom:""};var j=(x.attr("style")||"").toLowerCase();if(j){j=a.trim(j);var o=j.match(this.regexps.main);if(o){var q=a.trim(o[1]).replace(/\s+/g," ").split(" ",4);k.top=q[0];k.right=q[1]&&q[1]!==""?q[1]:k.top;k.bottom=q[2]&&q[2]!==""?q[2]:k.top;k.left=q[3]&&q[3]!==""?q[3]:k.right}else{a.each(["left","top","right","bottom"],function(){var r=this.toString();o=j.match(c.regexps[r]);if(o){k[r]=o[1]}})}}var x=k}a.each(["left","top","right","bottom"],function(){var t=this.toString();if(typeof(x[t])!="undefined"&&x[t]!==null){x[t]=x[t].toString();var v=b(x[t]);c[t].val(v);var r=x[t].match(/(px|em|pt|%)/i);c["u"+t].val(r?r[1]:"px")}});return this}};function b(h){h=a.trim(h.toString());if(h[0]=="."){h="0"+h}n=parseFloat(h);return !isNaN(n)?n:(h=="auto"?h:"")}function g(){d.change&&d.change(c)}this.val(d.value);return this};a.fn.elPaddingInput.defaults={name:"el-paddinginput","class":"el-paddinginput",type:"padding",value:{},percents:true,change:null}})(jQuery);(function(a){a.fn.elSelect=function(c){var p=this;var t=this.eq(0);var b=a.extend({},a.fn.elSelect.defaults,c);var f=a('<input type="hidden" />').attr("name",b.name);var k=a("<label />").attr({unselectable:"on"}).addClass("rounded-left-3");var g=null;var j=null;if(t.get(0).nodeName=="SELECT"){b.src={};t.children("option").each(function(){b.src[a(this).val()]=a(this).text()});b.value=t.val();b.name=t.attr("name");t.replaceWith((t=a("<div />")))}if(!b.value||!b.src[b.val]){b.value=null;var d=0;for(var q in b.src){if(d++==0){b.value=q}}}this.val=function(o){if(!o&&o!==""){return f.val()}else{if(b.src[o]){f.val(o);h(o);if(g){g.children().each(function(){if(a(this).attr("name")==o){a(this).addClass("active")}else{a(this).removeClass("active")}})}}return this}};function h(o){var u=b.labelTpl||b.tpls[o]||b.tpl;k.html(u.replace(/%val/g,o).replace(/%label/,b.src[o])).children().attr({unselectable:"on"})}t.empty().addClass(b["class"]+" rounded-3").attr({unselectable:"on"}).append(f).append(k).hover(function(){a(this).addClass("hover")},function(){a(this).removeClass("hover")}).click(function(o){!g&&r();g.slideToggle();if(a.browser.msie&&!j){g.children().each(function(){j=Math.max(j,a(this).width())});if(j>g.width()){g.width(j+40)}}});this.val(b.value);function r(){g=a("<div />").addClass(b.listClass+" rounded-3").hide().appendTo(t.mouseleave(function(v){g.slideUp()}));for(var u in b.src){var x=b.tpls[u]||b.tpl;a("<div />").attr("name",u).append(a(x.replace(/%val/g,u).replace(/%label/g,b.src[u])).attr({unselectable:"on"})).appendTo(g).hover(function(){a(this).addClass("hover")},function(){a(this).removeClass("hover")}).click(function(A){A.stopPropagation();A.preventDefault();var w=a(this).attr("name");p.val(w);b.select(w);g.slideUp()})}var o=t.outerWidth();if(g.width()<o){g.width(o)}var z=g.height();if(b.maxHeight>0&&z>b.maxHeight){g.height(b.maxHeight)}p.val(f.val())}return this};a.fn.elSelect.defaults={name:"el-select","class":"el-select",listClass:"list",labelTpl:null,tpl:"<%val>%label</%val>",tpls:{},value:null,src:{},select:function(b){window.console&&window.console.log&&window.console.log("selected: "+b)},maxHeight:310}})(jQuery);(function(a){elRTE=function(g,d){if(!g||!g.nodeName){return alert('elRTE: argument "target" is not DOM Element')}var b=this,c;this.version="1.0 RC1";this.build="20100204";this.options=a.extend(true,{},this.options,d);this.browser=a.browser;this.target=a(g);this.toolbar=a('<div class="toolbar"/>');this.iframe=document.createElement("iframe");this.workzone=a('<div class="workzone"/>').append(this.iframe).append(this.source);this.statusbar=a('<div class="statusbar"/>');this.tabsbar=a('<div class="tabsbar"/>');this.editor=a('<div class="'+this.options.cssClass+'" />').append(this.toolbar).append(this.workzone).append(this.statusbar).append(this.tabsbar);this.doc=null;this.$doc=null;this.window=null;this.utils=new this.utils(this);this.dom=new this.dom(this);this._i18n=new eli18n({textdomain:"rte",messages:{rte:this.i18Messages[this.options.lang]||{}}});this.editor.insertAfter(g);if(g.nodeName=="TEXTAREA"){this.source=this.target.remove();this.source.insertAfter(this.iframe).hide()}else{this.source=a("<textarea />").insertAfter(this.iframe).hide();this.source.val(this.target.hide().html()).attr("name",this.target.attr("id")||this.target.attr("name"))}this.source.val(this.filter(this.source.val(),true));if(this.options.allowSource){this.tabsbar.append('<div class="tab editor rounded-bottom-7 active">'+b.i18n("Editor")+'</div><div class="tab source rounded-bottom-7">'+b.i18n("Source")+'</div><div class="clearfix" style="clear:both"/>').children(".tab").click(function(h){if(!a(this).hasClass("active")){b.tabsbar.children(".tab").toggleClass("active");b.workzone.children().toggle();if(a(this).hasClass("editor")){b.val(b.source.val()||"&nbsp;");b.window.focus();b.ui.update(true)}else{b.updateSource();b.source.focus();if(a.browser.msie){}else{b.source[0].setSelectionRange(0,0)}b.ui.disable();b.statusbar.empty()}}})}this.window=this.iframe.contentWindow;this.doc=this.iframe.contentWindow.document;this.$doc=a(this.doc);c='<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';a.each(b.options.cssfiles,function(){c+='<link rel="stylesheet" type="text/css" href="'+this+'" />'});this.doc.open();this.doc.write(b.options.doctype+c+"</head><body>"+(this.source.val()||"&nbsp;")+"</body></html>");this.doc.close();if(a.browser.msie){this.doc.body.contentEditable=true}else{try{this.doc.designMode="on"}catch(f){}this.doc.execCommand("styleWithCSS",false,this.options.styleWithCSS)}this.window.focus();this.history=new this.history(this);this.selection=new this.selection(this);this.ui=new this.ui(this);this.target.parents("form").bind("submit",function(){b.source.is(":hidden")&&b.updateSource();b.toolbar.find(":hidden").remove()});this.$doc.bind("mouseup",function(){b.ui.update()}).bind("keyup",function(h){if((h.keyCode>=8&&h.keyCode<=13)||(h.keyCode>=32&&h.keyCode<=40)||h.keyCode==46||(h.keyCode>=96&&h.keyCode<=111)){b.ui.update()}}).bind("keydown",function(h){if((h.metaKey||h.ctrlKey)&&h.keyCode==65){b.ui.update()}else{if(h.keyCode==13){var j=b.selection.getNode();if(b.dom.selfOrParent(j,/^PRE$/)){b.selection.insertNode(b.doc.createTextNode("\r\n"));return false}else{if(a.browser.safari&&h.shiftKey){b.selection.insertNode(b.doc.createElement("br"));return false}}}}});this.typing=false;this.lastKey=null;this.$doc.bind("keydown",function(h){if((h.keyCode>=48&&h.keyCode<=57)||h.keyCode==61||h.keyCode==109||(h.keyCode>=65&&h.keyCode<=90)||h.keyCode==188||h.keyCode==190||h.keyCode==191||(h.keyCode>=219&&h.keyCode<=222)){if(!b.typing){b.history.add(true)}b.typing=true;b.lastKey=null}else{if(h.keyCode==8||h.keyCode==46||h.keyCode==32||h.keyCode==13){if(h.keyCode!=b.lastKey){b.history.add(true)}b.lastKey=h.keyCode;b.typing=false}}}).bind("mouseup",function(){b.typing=false;b.lastKey=null})};elRTE.prototype.i18n=function(b){return this._i18n.translate(b)};elRTE.prototype.open=function(){this.editor.show()};elRTE.prototype.close=function(){this.editor.hide()};elRTE.prototype.updateSource=function(){this.source.val(this.filter(a(this.doc.body).html()))};elRTE.prototype.val=function(b){if(typeof(b)=="string"){a(this.doc.body).html(this.filter(b,true))}else{this.updateSource();return this.source.val()}};elRTE.prototype.save=function(){this.editor.parents("form").submit()};elRTE.prototype.filter=function(d,c){var f="";var g=a("<span />");if(!d.nodeType){f=a.trim(d)}else{f=a.trim(d.nodeType==1?a(d).html():d.nodeValue)}var b=this.options.stripWhiteSpace;a.each(this.filters.html,function(){f=this(f,b)});g.html(f);if(c){g.find("a").each(function(){if(a(this).attr("name")){a(this).addClass("el-rte-anchor")}})}else{g.find("a.el-rte-anchor").each(function(){if(a.trim(a(this).attr("class"))=="el-rte-anchor"){a(this).removeAttr("class")}else{a(this).removeClass("el-rte-anchor")}})}a.each(this.filters.dom,function(){g=this(g)});return g.html()};elRTE.prototype.filters={dom:[function(b){b.find("[align]").not("tbody,tr").each(function(){var c=(a(this).attr("align")||"").toLowerCase();if((this.nodeName!="TD"&&this.nodeName!="TH")||c!="left"){a(this).css("text-align",c).removeAttr("align")}}).end().end().find("[border],[bordercolor]").each(function(){var d=parseInt(a(this).attr("border"))||1,f=a(this).attr("bordercolor")||"#000";a(this).css("border",d+"px solid "+f).removeAttr("border").removeAttr("bordercolor")}).end().find("[bgcolor]").each(function(){a(this).css("background-color",a(this).attr("bgcolor")).removeAttr("bgcolor")}).end().find("[background]").each(function(){a(this).css("background","url("+a(this).attr("background")+")").removeAttr("background")}).end().find("img[hspace],[vspace]").each(function(){var c=parseInt(a(this).attr("vspace"))||0,d=parseInt(a(this).attr("hspace"))||0;if(c>0||d>0){a(this).css("margin",(c>0?c:0)+"px "+(d>0?d:0)+"px")}a(this).removeAttr("hspace").removeAttr("vspace")}).end().find("[clear]").each(function(){var d=(a(this).attr("clear")||"").toLowerCase();a(this).css("clear",d=="all"?"both":d)});if(a.browser.safari){b.find(".Apple-style-span").removeClass("Apple-style-span")}return b}],html:[function(c,d){var b={1:"xx-small",2:"x-small",3:"small",4:"medium",5:"large",6:"x-large",7:"xx-large"};c=c.replace(/<font([^>]*)/i,function(j,g){var h="",f=g.match(/size=('|")(\d)/i);if(f&&f[2]&&b[f[2]]){h="font-size: "+b[f[2]]+"; "}f=g.match(/face=('|")([a-z0-9\s,]+)/i);if(f&&f[2]){h+="font-family: "+f[2]}return"<span"+(h?' style="'+h+'"':"")}).replace(/<\/font/i,"</span").replace(/<b(\s[^>]*)?>/i,"<strong$1>").replace(/<\/b\s*>/i,"</strong>").replace(/<i(\s[^>]*)?>/i,"<em$1>").replace(/<\/i\s*>/i,"</em>").replace(/((class|style)="")/i,"");if(d){c=c.replace(/\r?\n(\s)*/mg,"\n")}return c}]};elRTE.prototype.log=function(b){if(window.console&&window.console.log){window.console.log(b)}};elRTE.prototype.i18Messages={};a.fn.elrte=function(d){var c=typeof(d)=="string"?d:"",b;this.each(function(){if(!this.elrte){this.elrte=new elRTE(this,typeof(d)=="object"?d:{})}switch(c){case"open":case"show":this.elrte.open();break;case"close":case"hide":this.elrte.close();break;case"updateSource":this.elrte.updateSource();break}});if(c=="val"){if(!this.length){return""}else{if(this.length==1){return this[0].elrte.val()}else{b={};this.each(function(){b[this.elrte.source.attr("name")]=this.elrte.val()});return b}}}return this}})(jQuery);(function(a){elRTE.prototype.dom=function(c){this.rte=c;var b=this;this.regExp={textNodes:/^(A|ABBR|ACRONYM|ADDRESS|B|BDO|BIG|BLOCKQUOTE|CAPTION|CENTER|CITE|CODE|DD|DEL|DFN|DIV|DT|EM|FIELDSET|FONT|H[1-6]|I|INS|KBD|LABEL|LEGEND|LI|MARQUEE|NOBR|NOEMBED|P|PRE|Q|SAMP|SMALL|SPAN|STRIKE|STRONG|SUB|SUP|TD|TH|TT|VAR)$/,textContainsNodes:/^(A|ABBR|ACRONYM|ADDRESS|B|BDO|BIG|BLOCKQUOTE|CAPTION|CENTER|CITE|CODE|DD|DEL|DFN|DIV|DL|DT|EM|FIELDSET|FONT|H[1-6]|I|INS|KBD|LABEL|LEGEND|LI|MARQUEE|NOBR|NOEMBED|OL|P|PRE|Q|SAMP|SMALL|SPAN|STRIKE|STRONG|SUB|SUP|TABLE|THEAD|TBODY|TFOOT|TD|TH|TR|TT|UL|VAR)$/,block:/^(APPLET|BLOCKQUOTE|BR|CAPTION|CENTER|COL|COLGROUP|DD|DIV|DL|DT|H[1-6]|EMBED|FIELDSET|LI|MARQUEE|NOBR|OBJECT|OL|P|PRE|TABLE|THEAD|TBODY|TFOOT|TD|TH|TR|UL)$/,selectionBlock:/^(APPLET|BLOCKQUOTE|BR|CAPTION|CENTER|COL|COLGROUP|DD|DIV|DL|DT|H[1-6]|EMBED|FIELDSET|LI|MARQUEE|NOBR|OBJECT|OL|P|PRE|TD|TH|TR|UL)$/,header:/^H[1-6]$/,formElement:/^(FORM|INPUT|HIDDEN|TEXTAREA|SELECT|BUTTON)$/};this.root=function(){return this.rte.body};this.create=function(d){return this.rte.doc.createElement(d)};this.indexOf=function(f){var d=0;f=a(f);while((f=f.prev())&&f.length){d++}return d};this.attr=function(g,d){var f="";if(g.nodeType==1){f=a(g).attr(d);if(f&&d!="src"&&d!="href"){f=f.toString().toLowerCase()}}return f||""};this.findCommonAncestor=function(h,g){if(!h||!g){return this.rte.log("dom.findCommonAncestor invalid arguments")}if(h==g){return h}else{if(h.nodeName=="BODY"||g.nodeName=="BODY"){return this.rte.doc.body}}var k=a(h).parents(),j=a(g).parents(),d=j.length-1,o=j[d];for(var f=k.length-1;f>=0;f--,d--){if(k[f]==j[d]){o=k[f]}else{break}}return o};this.isEmpty=function(d){if(d.nodeType==1){return this.regExp.textNodes.test(d.nodeName)?a.trim(a(d).text()).length==0:false}else{if(d.nodeType==3){return/^(TABLE|THEAD|TFOOT|TBODY|TR|UL|OL|DL)$/.test(d.parentNode.nodeName)||d.nodeValue==""||(a.trim(d.nodeValue).length==0&&!(d.nextSibling&&d.previousSibling&&d.nextSibling.nodeType==1&&d.previousSibling.nodeType==1&&!this.regExp.block.test(d.nextSibling.nodeName)&&!this.regExp.block.test(d.previousSibling.nodeName)))}}return true};this.next=function(d){while(d.nextSibling&&(d=d.nextSibling)){if(d.nodeType==1||(d.nodeType==3&&!this.isEmpty(d))){return d}}return null};this.prev=function(d){while(d.previousSibling&&(d=d.previousSibling)){if(d.nodeType==1||(d.nodeType==3&&!this.isEmpty(d))){return d}}return null};this.isPrev=function(f,d){while((f=this.prev(f))){if(f==d){return true}}return false};this.nextAll=function(f){var d=[];while((f=this.next(f))){d.push(f)}return d};this.prevAll=function(f){var d=[];while((f=this.prev(f))){d.push(f)}return d};this.toLineEnd=function(f){var d=[];while((f=this.next(f))&&f.nodeName!="BR"&&f.nodeName!="HR"&&this.isInline(f)){d.push(f)}return d};this.toLineStart=function(f){var d=[];while((f=this.prev(f))&&f.nodeName!="BR"&&f.nodeName!="HR"&&this.isInline(f)){d.unshift(f)}return d};this.isFirstNotEmpty=function(d){while((d=this.prev(d))){if(d.nodeType==1||(d.nodeType==3&&a.trim(d.nodeValue)!="")){return false}}return true};this.isLastNotEmpty=function(d){while((d=this.next(d))){if(!this.isEmpty(d)){return false}}return true};this.isOnlyNotEmpty=function(d){return this.isFirstNotEmpty(d)&&this.isLastNotEmpty(d)};this.findLastNotEmpty=function(d){this.rte.log("findLastNotEmpty Who is here 0_o");if(d.nodeType==1&&(l=d.lastChild)){if(!this.isEmpty(l)){return l}while(l.previousSibling&&(l=l.previousSibling)){if(!this.isEmpty(l)){return l}}}return false};this.isInline=function(j){if(j.nodeType==3){return true}else{if(j.nodeType==1){j=a(j);var h=j.css("display");var g=j.css("float");return h=="inline"||h=="inline-block"||g=="left"||g=="right"}}return true};this.filter=function(j,h){var g=typeof(h),d=[],f;if(g=="object"||g=="string"){h=this.regExp[h]||h;if(!j.push){return j.nodeName&&h.test(j.nodeName)?j:null}for(f=0;f<j.length;f++){if(j[f].nodeName&&j[f].nodeName&&h.test(j[f].nodeName)){d.push(j[f])}}return d}return null};this.parents=function(h,g){var f=typeof(g),d=[];if(f=="object"||f=="string"){g=g=="*"?/.?/:(this.regExp[g]||g);while(h&&(h=h.parentNode)&&h.nodeName!="BODY"&&h.nodeName!="HTML"){if(g.test(h.nodeName)){d.push(h)}}}return d};this.parent=function(g,d){return this.parents(g,d)[0]||null};this.selfOrParent=function(g,f,d){return this.filter(g,f)||this.parent(g,d||f)};this.selfOrParentLink=function(d){d=this.selfOrParent(d,/^A$/);return d&&d.href?d:null};this.selfOrParentAnchor=function(d){d=this.selfOrParent(d,/^A$/);return d&&!d.href&&d.name?d:null};this.childLinks=function(f){var d=[];a("a[href]",f).each(function(){d.push(this)});return d};this.wrap=function(f,d){f=f.length?f:[f];d=d.nodeName?d:this.create(d);d=f[0].parentNode.insertBefore(d,f[0]);a(f).each(function(){if(this!=d){d.appendChild(this)}});return d};this.wrapContents=function(g,d){d=d.nodeName?d:this.create(d);for(var f=0;f<g.childNodes.length;f++){d.appendChild(g.childNodes[f])}g.appendChild(d);return d};this.cleanNode=function(d){if(d.nodeType!=1){return}if(/^(P|LI)$/.test(d.nodeName)&&(l=this.findLastNotEmpty(d))&&l.nodeName=="BR"){a(l).remove()}$n=a(d);$n.children().each(function(){this.cleanNode(this)});if(d.nodeName!="BODY"&&!/^(TABLE|TR|TD)$/.test(d)&&this.isEmpty(d)){return $n.remove()}if($n.attr("style")===""){$n.removeAttr("style")}if(this.rte.browser.safari&&$n.hasClass("Apple-span")){$n.removeClass("Apple-span")}if(d.nodeName=="SPAN"&&!$n.attr("style")&&!$n.attr("class")&&!$n.attr("id")){$n.replaceWith($n.html())}};this.cleanChildNodes=function(f){var d=this.cleanNode;a(f).children().each(function(){d(this)})};this.tableMatrix=function(h){var g=[];if(h&&h.nodeName=="TABLE"){var f=0;function d(k){for(var j=0;j<=f;j++){if(!g[k][j]){return j}}}a(h).find("tr").each(function(j){if(!a.isArray(g[j])){g[j]=[]}a(this).children("td,th").each(function(){var o=parseInt(a(this).attr("colspan")||1);var r=parseInt(a(this).attr("rowspan")||1);var q=d(j);for(var u=0;u<r;u++){for(var k=0;k<o;k++){var p=j+u;if(!a.isArray(g[p])){g[p]=[]}var t=k==0&&u==0?this:(u==0?k:"-");g[p][q+k]=t}}f=Math.max(f,g[j].length)})})}return g};this.indexesOfCell=function(h,g){for(var d=0;d<g.length;d++){for(var f=0;f<g[d].length;f++){if(g[d][f]==h){return[d,f]}}}};this.fixTable=function(p){if(p&&p.nodeName=="TABLE"){var g=a(p);var o=this.tableMatrix(p);var d=0;a.each(o,function(){d=Math.max(d,this.length)});if(d==0){return g.remove()}for(var j=0;j<o.length;j++){var f=o[j].length;if(f==0){g.find("tr").eq(j).remove()}else{if(f<d){var h=d-f;var k=g.find("tr").eq(j);for(i=0;i<h;i++){k.append("<td>&nbsp;</td>")}}}}}};this.tableColumn=function(h,g,o){h=this.selfOrParent(h,/^TD|TH$/);var j=this.selfOrParent(h,/^TABLE$/);ret=[];info={offset:[],delta:[]};if(h&&j){o&&this.fixTable(j);var u=this.tableMatrix(j);var v=false;var t;for(var f=0;f<u.length;f++){for(var q=0;q<u[f].length;q++){if(u[f][q]==h){t=q;v=true;break}}if(v){break}}if(t>=0){for(var f=0;f<u.length;f++){var k=u[f][t]||null;if(k){if(k.nodeName){ret.push(k);if(g){info.delta.push(0);info.offset.push(t)}}else{var p=parseInt(k);if(!isNaN(p)&&u[f][t-p]&&u[f][t-p].nodeName){ret.push(u[f][t-p]);if(g){info.delta.push(p);info.offset.push(t)}}}}}}}return !g?ret:{column:ret,info:info}}}})(jQuery);(function(a){elRTE.prototype.history=function(b){this.rte=b;this._prev=[];this._next=[];this.add=function(){if(this.rte.options.historyLength>0&&this._prev.length>=this.rte.options.historyLength){this._prev.slice(this.rte.options.historyLength)}this._prev.push(a(this.rte.doc.body).html());this._next=[]};this.back=function(){if(this._prev.length){this._next.push(a(this.rte.doc.body).html());a(this.rte.doc.body).html(this._prev.pop())}};this.fwd=function(){if(this._next.length){this._prev.push(a(this.rte.doc.body).html());a(this.rte.doc.body).html(this._next.pop())}};this.canBack=function(){return this._prev.length};this.canFwd=function(){return this._next.length}}})(jQuery);(function(a){elRTE.prototype.options={doctype:'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">',cssClass:"el-rte",cssfiles:[],height:null,lang:"en",toolbar:"normal",absoluteURLs:true,allowSource:true,stripWhiteSpace:false,styleWithCSS:false,fmAllow:true,fmOpen:null,buttons:{save:"Save",copy:"Copy",cut:"Cut",paste:"Paste",pastetext:"Paste only text",pasteformattext:"Paste formatted text",removeformat:"Clean format",undo:"Undo last action",redo:"Redo previous action",bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",superscript:"Superscript",subscript:"Subscript",justifyleft:"Align left",justifyright:"Ailgn right",justifycenter:"Align center",justifyfull:"Align full",indent:"Indent",outdent:"Outdent",forecolor:"Font color",hilitecolor:"Background color",formatblock:"Format",fontsize:"Font size",fontname:"Font",insertorderedlist:"Ordered list",insertunorderedlist:"Unordered list",horizontalrule:"Horizontal rule",blockquote:"Blockquote",div:"Block element (DIV)",link:"Link",unlink:"Delete link",anchor:"Bookmark",image:"Image",table:"Table",tablerm:"Delete table",tableprops:"Table properties",tbcellprops:"Table cell properties",tbrowbefore:"Insert row before",tbrowafter:"Insert row after",tbrowrm:"Delete row",tbcolbefore:"Insert column before",tbcolafter:"Insert column after",tbcolrm:"Delete column",tbcellsmerge:"Merge table cells",tbcellsplit:"Split table cell",docstructure:"Toggle display document structure",elfinder:"Open file manager",fullscreen:"Toggle full screen mode",nbsp:"Non breakable space",stopfloat:"Stop element floating"},panels:{save:["save"],copypaste:["copy","cut","paste","pastetext","pasteformattext","removeformat","docstructure"],undoredo:["undo","redo"],style:["bold","italic","underline","strikethrough","subscript","superscript"],colors:["forecolor","hilitecolor"],alignment:["justifyleft","justifycenter","justifyright","justifyfull"],indent:["outdent","indent"],format:["formatblock","fontsize","fontname"],lists:["insertorderedlist","insertunorderedlist"],elements:["horizontalrule","blockquote","div","stopfloat","nbsp"],links:["link","unlink","anchor"],images:["image"],media:["image"],tables:["table","tableprops","tablerm","tbrowbefore","tbrowafter","tbrowrm","tbcolbefore","tbcolafter","tbcolrm","tbcellprops","tbcellsmerge","tbcellsplit"],elfinder:["elfinder"],fullscreen:["fullscreen"]},toolbars:{tiny:["style"],compact:["save","undoredo","style","alignment","lists","links","fullscreen"],normal:["save","copypaste","undoredo","style","alignment","colors","indent","lists","links","elements","images","fullscreen"],complite:["save","copypaste","undoredo","style","alignment","colors","format","indent","lists","links","elements","media","fullscreen"],maxi:["save","copypaste","undoredo","style","alignment","colors","format","indent","lists","links","elements","media","tables","fullscreen"],eldorado:["save","copypaste","elfinder","undoredo","style","alignment","colors","format","indent","lists","links","elements","media","tables","fullscreen"]},panelNames:{save:"Save",copypaste:"Copy/Pase",undoredo:"Undo/Redo",style:"Text styles",colors:"Colors",alignment:"Alignment",indent:"Indent/Outdent",format:"Text format",lists:"Lists",elements:"Misc elements",links:"Links",images:"Images",media:"Media",tables:"Tables",elfinder:"File manager (elFinder)"}}})(jQuery);(function(a){elRTE.prototype.selection=function(f){this.rte=f;var c=this;this.w3cRange=null;var k,b,h,j;a(this.rte.doc).keyup(function(o){if(o.ctrlKey||o.metaKey||(o.keyCode>=8&&o.keyCode<=13)||(o.keyCode>=32&&o.keyCode<=40)||o.keyCode==46||(o.keyCode>=96&&o.keyCode<=111)){c.cleanCache()}}).mousedown(function(o){if(o.target.nodeName=="HTML"){k=c.rte.doc.body}else{k=o.target}b=h=null}).mouseup(function(o){if(o.target.nodeName=="HTML"){b=c.rte.doc.body}else{b=o.target}b=o.target;h=null}).click();function g(){return c.rte.window.getSelection?c.rte.window.getSelection():c.rte.window.document.selection}function d(r,q,o){while(r.nodeName!="BODY"&&r.parentNode&&r.parentNode.nodeName!="BODY"&&(q?r!==q&&r.parentNode!=q:1)&&((o=="left"&&c.rte.dom.isFirstNotEmpty(r))||(o=="right"&&c.rte.dom.isLastNotEmpty(r))||(c.rte.dom.isFirstNotEmpty(r)&&c.rte.dom.isLastNotEmpty(r)))){r=r.parentNode}return r}this.collapsed=function(){return this.getRangeAt().isCollapsed()};this.collapse=function(o){this.getRangeAt().collapse(o?true:false)};this.getRangeAt=function(q){if(this.rte.browser.msie){if(!this.w3cRange){this.w3cRange=new this.rte.w3cRange(this.rte)}q&&this.w3cRange.update();return this.w3cRange}var o=g();var p=o.rangeCount>0?o.getRangeAt(0):this.rte.doc.createRange();p.getStart=function(){return this.startContainer.nodeType==1?this.startContainer.childNodes[Math.min(this.startOffset,this.startContainer.childNodes.length-1)]:this.startContainer};p.getEnd=function(){return this.endContainer.nodeType==1?this.endContainer.childNodes[Math.min(this.startOffset==this.endOffset?this.endOffset:this.endOffset-1,this.endContainer.childNodes.length-1)]:this.endContainer};p.isCollapsed=function(){return this.collapsed};return p};this.saveIERange=function(){if(a.browser.msie){j=this.getRangeAt().getBookmark()}};this.restoreIERange=function(){a.browser.msie&&j&&this.getRangeAt().moveToBookmark(j)};this.select=function(o,q){q=q||o;var p=this.getRangeAt();p.setStartBefore(o);p.setEndAfter(q);if(this.rte.browser.msie){p.select()}else{var o=g();o.removeAllRanges();o.addRange(p)}return this.cleanCache()};this.selectContents=function(t){var p=this.getRangeAt();if(t&&t.nodeType==1){if(this.rte.browser.msie){p.range();p.r.moveToElementText(t.parentNode);p.r.select()}else{try{p.selectNodeContents(t)}catch(q){return this.rte.log("unable select node contents "+t)}var o=g();o.removeAllRanges();o.addRange(p)}}return this};this.insertNode=function(u,t){if(t&&!this.collapsed()){this.collapse()}if(this.rte.browser.msie){var o=u.nodeType==3?u.nodeValue:a(this.rte.dom.create("span")).append(a(u)).html();var q=this.getRangeAt();q.insertNode(o)}else{var q=this.getRangeAt();q.insertNode(u);q.setStartAfter(u);q.setEndAfter(u);var p=g();p.removeAllRanges();p.addRange(q)}return this.cleanCache()};this.insertHtml=function(o,p){if(p&&!this.collapsed()){this.collapse()}if(this.rte.browser.msie){this.getRangeAt().range().pasteHTML(o)}else{var q=a(this.rte.dom.create("span")).html(o||"").get(0);this.insertNode(q);a(q).replaceWith(a(q).html())}return this.cleanCache()};this.insertText=function(p,o){var q=this.rte.doc.createTextNode(p);return this.insertHtml(q.nodeValue)};this.cleanCache=function(){k=b=h=null;return this};this.getStart=function(){if(!k){var o=this.getRangeAt();k=o.getStart()}return k};this.getEnd=function(){if(!b){var o=this.getRangeAt();b=o.getEnd()}return b};this.getNode=function(){if(!h){h=this.rte.dom.findCommonAncestor(this.getStart(),this.getEnd())}return h};this.selected=function(r){var p={collapsed:false,blocks:false,filter:false,wrap:"text",tag:"span"};p=a.extend({},p,r);if(p.blocks){var v=this.getNode(),u=null;if(u=this.rte.dom.selfOrParent(v,"selectionBlock")){return[u]}}var t=this.selectedRaw(p.collapsed,p.blocks);var A=[];var w=[];var B=null;function q(){function C(){for(var E=0;E<w.length;E++){if(w[E].nodeType==1&&(c.rte.dom.selfOrParent(w[E],/^P$/)||a(w[E]).find("p").length>0)){return false}}return true}if(w.length>0){var o=p.tag=="p"&&!C()?"div":p.tag;var D=c.rte.dom.wrap(w,o);A[B]=D;B=null;w=[]}}function z(D){if(D.nodeType==1){if(/^(THEAD|TFOOT|TBODY|COL|COLGROUP|TR)$/.test(D.nodeName)){a(D).find("td,th").each(function(){var E=p.tag=="p"&&a(this).find("p").length>0?"div":p.tag;var F=c.rte.dom.wrapContents(this,E);return A.push(F)})}else{if(/^(CAPTION|TD|TH|LI|DT|DD)$/.test(D.nodeName)){var o=p.tag=="p"&&a(D).find("p").length>0?"div":p.tag;var D=c.rte.dom.wrapContents(D,o);return A.push(D)}}}var C=w.length>0?w[w.length-1]:null;if(C&&C!=c.rte.dom.prev(D)){q()}w.push(D);if(B===null){B=A.length;A.push("dummy")}}if(t.nodes.length>0){for(var x=0;x<t.nodes.length;x++){var v=t.nodes[x];if(v.nodeType==3&&(x==0||x==t.nodes.length-1)&&a.trim(v.nodeValue).length>0){if(x==0&&t.so>0){v=v.splitText(t.so)}if(x==t.nodes.length-1&&t.eo>0){v.splitText(x==0&&t.so>0?t.eo-t.so:t.eo)}}switch(p.wrap){case"text":if((v.nodeType==1&&v.nodeName=="BR")||(v.nodeType==3&&a.trim(v.nodeValue).length>0)){z(v)}else{if(v.nodeType==1){A.push(v)}}break;case"inline":if(this.rte.dom.isInline(v)){z(v)}else{if(v.nodeType==1){A.push(v)}}break;case"all":if(v.nodeType==1||!this.rte.dom.isEmpty(v)){z(v)}break;default:if(v.nodeType==1||!this.rte.dom.isEmpty(v)){A.push(v)}}}q()}return p.filter?this.rte.dom.filter(A,p.filter):A};this.dump=function(o,q,v,u,p){var t=this.getRangeAt();this.rte.log("commonAncestorContainer");this.rte.log(o||t.commonAncestorContainer);this.rte.log("startContainer");this.rte.log(q||t.startContainer);this.rte.log("startOffset: "+(u>=0?u:t.startOffset));this.rte.log("endContainer");this.rte.log(v||t.endContainer);this.rte.log("endOffset: "+(p>=0?p:t.endOffset))};this.selectedRaw=function(x,o){var E={so:null,eo:null,nodes:[]};var p=this.getRangeAt(true);var v=p.commonAncestorContainer;var G,D;var C=false;var A=false;function B(I,r,H){if(I.nodeType==3){H=H>=0?H:I.nodeValue.length;return(r==0&&H==I.nodeValue.length)||a.trim(I.nodeValue).length==a.trim(I.nodeValue.substring(r,H)).length}return true}function w(I,r,H){if(I.nodeType==1){return c.rte.dom.isEmpty(I)}else{if(I.nodeType==3){return a.trim(I.nodeValue.substring(r||0,H>=0?H:I.nodeValue.length)).length==0}}return true}if(p.startContainer.nodeType==1){if(p.startOffset<p.startContainer.childNodes.length){G=p.startContainer.childNodes[p.startOffset];E.so=G.nodeType==1?null:0}else{G=p.startContainer.childNodes[p.startOffset-1];E.so=G.nodeType==1?null:G.nodeValue.length}}else{G=p.startContainer;E.so=p.startOffset}if(p.collapsed){if(x){if(o){G=d(G);if(!this.rte.dom.isEmpty(G)||(G=this.rte.dom.next(G))){E.nodes=[G]}if(this.rte.dom.isInline(G)){E.nodes=this.rte.dom.toLineStart(G).concat(E.nodes,this.rte.dom.toLineEnd(G))}if(E.nodes.length>0){E.so=E.nodes[0].nodeType==1?null:0;E.eo=E.nodes[E.nodes.length-1].nodeType==1?null:E.nodes[E.nodes.length-1].nodeValue.length}}else{if(!this.rte.dom.isEmpty(G)){E.nodes=[G]}}}return E}if(p.endContainer.nodeType==1){D=p.endContainer.childNodes[p.endOffset-1];E.eo=D.nodeType==1?null:D.nodeValue.length}else{D=p.endContainer;E.eo=p.endOffset}if(G.nodeType==1||o||B(G,E.so,G.nodeValue.length)){G=d(G,v,"left");C=true;E.so=G.nodeType==1?null:0}if(D.nodeType==1||o||B(D,0,E.eo)){D=d(D,v,"right");A=true;E.eo=D.nodeType==1?null:D.nodeValue.length}if(o){if(G.nodeType!=1&&G.parentNode!=v&&G.parentNode.nodeName!="BODY"){G=G.parentNode;E.so=null}if(D.nodeType!=1&&D.parentNode!=v&&D.parentNode.nodeName!="BODY"){D=D.parentNode;E.eo=null}}if(G.parentNode==D.parentNode&&G.parentNode.nodeName!="BODY"&&(C&&this.rte.dom.isFirstNotEmpty(G))&&(A&&this.rte.dom.isLastNotEmpty(D))){G=D=G.parentNode;E.so=G.nodeType==1?null:0;E.eo=D.nodeType==1?null:D.nodeValue.length}if(G==D){if(!this.rte.dom.isEmpty(G)){E.nodes.push(G)}return E}var q=G;while(q.nodeName!="BODY"&&q.parentNode!==v&&q.parentNode.nodeName!="BODY"){q=q.parentNode}var F=D;while(F.nodeName!="BODY"&&F.parentNode!==v&&F.parentNode.nodeName!="BODY"){this.rte.log(F);F=F.parentNode}if(!w(G,E.so,G.nodeType==3?G.nodeValue.length:null)){E.nodes.push(G)}var u=G;while(u!==q){var t=u;while((t=this.rte.dom.next(t))){E.nodes.push(t)}u=u.parentNode}u=q;while((u=this.rte.dom.next(u))&&u!=F){E.nodes.push(u)}var z=[];u=D;while(u!==F){var t=u;while((t=this.rte.dom.prev(t))){z.push(t)}u=u.parentNode}if(z.length){E.nodes=E.nodes.concat(z.reverse())}if(!w(D,0,D.nodeType==3?E.eo:null)){E.nodes.push(D)}if(o){if(this.rte.dom.isInline(G)){E.nodes=this.rte.dom.toLineStart(G).concat(E.nodes);E.so=E.nodes[0].nodeType==1?null:0}if(this.rte.dom.isInline(D)){E.nodes=E.nodes.concat(this.rte.dom.toLineEnd(D));E.eo=E.nodes[E.nodes.length-1].nodeType==1?null:E.nodes[E.nodes.length-1].nodeValue.length}}return E}}})(jQuery);(function(a){elRTE.prototype.ui=function(d){this.rte=d;this._buttons=[];var u=this,k=this.rte.options.toolbars[d.options.toolbar&&d.options.toolbars[d.options.toolbar]?d.options.toolbar:"normal"],q=k.length,f,j,h,g,r,t,o;for(o in this.buttons){if(this.buttons.hasOwnProperty(o)&&o!="button"){this.buttons[o].prototype=this.buttons.button.prototype}}while(q--){j=k[q];f=a('<ul class="panel-'+j+(q==0?" first":"")+'" />').prependTo(this.rte.toolbar);h=this.rte.options.panels[j].length;while(h--){g=this.rte.options.panels[j][h];r=this.buttons[g]||this.buttons.button;this._buttons.push((t=new r(this.rte,g)));f.prepend(t.domElem)}}this.update();this.disable=function(){a.each(u._buttons,function(){!this.active&&this.domElem.addClass("disabled")})}};elRTE.prototype.ui.prototype.update=function(b){b&&this.rte.selection.cleanCache();var f=this.rte.selection.getNode(),d=this.rte.dom.parents(f,"*"),c="";if(d.length){a.each(d.reverse(),function(){c+=" &raquo; "+this.nodeName.toLowerCase()})}if(f.nodeType==1&&f.nodeName!="BODY"){c+=" &raquo; "+f.nodeName.toLowerCase()}this.rte.statusbar.html(c);a.each(this._buttons,function(){this.update()});this.rte.window.focus()};elRTE.prototype.ui.prototype.buttons={button:function(d,c){var b=this;this.rte=d;this.active=false;this.name=c;this.val=null;this.domElem=a('<li style="-moz-user-select:-moz-none" class="'+c+' rounded-3" name="'+c+'" title="'+this.rte.i18n(this.rte.options.buttons[c]||c)+'" unselectable="on" />').hover(function(){a(this).addClass("hover")},function(){a(this).removeClass("hover")}).click(function(f){f.stopPropagation();f.preventDefault();if(!a(this).hasClass("disabled")){b.command()}b.rte.window.focus()})}};elRTE.prototype.ui.prototype.buttons.button.prototype.command=function(){this.rte.history.add();try{this.rte.doc.execCommand(this.name,false,this.val)}catch(b){return this.rte.log("commands failed: "+this.name)}this.rte.ui.update(true)};elRTE.prototype.ui.prototype.buttons.button.prototype.update=function(){try{if(!this.rte.doc.queryCommandEnabled(this.name)){return this.domElem.addClass("disabled")}else{this.domElem.removeClass("disabled")}}catch(b){return}try{if(this.rte.doc.queryCommandState(this.name)){this.domElem.addClass("active")}else{this.domElem.removeClass("active")}}catch(b){}}})(jQuery);(function(a){elRTE.prototype.utils=function(c){this.rte=c;this.url=null;this.reg=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;this.baseURL="";this.path="";var b=this;this.rgb2hex=function(g){function f(h){hexDigits=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return !h?"00":hexDigits[(h-h%16)/16]+hexDigits[h%16]}var d=g?g.match(/\(([0-9]{1,3}),\s*([0-9]{1,3}),\s*([0-9]{1,3})\)/):"";return d?"#"+f(d[1])+f(d[2])+f(d[3]):""};this.toPixels=function(f){var d=f.match(/([0-9]+\.?[0-9]*)\s*(px|pt|em|%)/);if(d){f=d[1];unit=d[2]}if(f[0]=="."){f="0"+f}f=parseFloat(f);if(isNaN(f)){return""}var g=parseInt(a(document.body).css("font-size"))||16;switch(unit){case"em":return parseInt(f*g);case"pt":return parseInt(f*g/12);case"%":return parseInt(f*g/100)}return f};this.absoluteURL=function(f){!this.url&&this._url();f=a.trim(f);if(!f){return""}if(f[0]=="#"){return f}var d=this.parseURL(f);if(!d.host&&!d.path&&!d.anchor){return""}if(!this.rte.options.absoluteURLs){return f}if(d.protocol){return f}if(d.host&&(d.host.indexOf(".")!=-1||d.host=="localhost")){return this.url.protocol+"://"+f}if(f[0]=="/"){f=this.baseURL+f}else{if(f.indexOf("./")==0){f=f.substring(2)}f=this.baseURL+this.path+f}return f};this.parseURL=function(g){var f=g.match(this.reg);var d={};a.each(["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],function(h){d[this]=f[h]});if(!d.host.match(/[a-z0-9]/i)){d.host=""}return d};this.trimEventCallback=function(d){d=d?d.toString():"";return a.trim(d.replace(/\r*\n/mg,"").replace(/^function\s*on[a-z]+\s*\(\s*event\s*\)\s*\{(.+)\}$/igm,"$1"))};this._url=function(){this.url=this.parseURL(window.location.href);this.baseURL=this.url.protocol+"://"+(this.url.userInfo?parts.userInfo+"@":"")+this.url.host+(this.url.port?":"+this.url.port:"");this.path=!this.url.file?this.url.path:this.url.path.substring(0,this.url.path.length-this.url.file.length)}}})(jQuery);(function(a){elRTE.prototype.w3cRange=function(c){var b=this;this.rte=c;this.r=null;this.collapsed=true;this.startContainer=null;this.endContainer=null;this.startOffset=0;this.endOffset=0;this.commonAncestorContainer=null;this.range=function(){try{this.r=this.rte.window.document.selection.createRange()}catch(d){this.r=this.rte.doc.body.createTextRange()}return this.r};this.insertNode=function(d){this.range();b.r.collapse(false);var f=b.r.duplicate();f.pasteHTML(d)};this.getBookmark=function(){this.range();if(this.r.item){var d=this.r.item(0);this.r=this.rte.doc.body.createTextRange();this.r.moveToElementText(d)}return this.r.getBookmark()};this.moveToBookmark=function(d){this.rte.window.focus();this.range().moveToBookmark(d);this.r.select()};this.update=function(){function g(w){var j="\uFEFF";var k=offset=0;var q=b.r.duplicate();q.collapse(w);var t=q.parentElement();if(!t||t.nodeName=="HTML"){return{parent:b.rte.doc.body,ndx:k,offset:offset}}q.pasteHTML(j);childs=t.childNodes;for(var o=0;o<childs.length;o++){var v=childs[o];if(o>0&&(v.nodeType!==3||childs[o-1].nodeType!==3)){k++}if(v.nodeType!==3){offset=0}else{var u=v.nodeValue.indexOf(j);if(u!==-1){offset+=u;break}offset+=v.nodeValue.length}}q.moveStart("character",-1);q.text="";return{parent:t,ndx:Math.min(k,t.childNodes.length-1),offset:offset}}this.range();this.startContainer=this.endContainer=null;if(this.r.item){this.collapsed=false;var f=this.r.item(0);this.setStart(f.parentNode,this.rte.dom.indexOf(f));this.setEnd(f.parentNode,this.startOffset+1)}else{this.collapsed=this.r.boundingWidth==0;var h=g(true);var d=g(false);h.parent.normalize();d.parent.normalize();h.ndx=Math.min(h.ndx,h.parent.childNodes.length-1);d.ndx=Math.min(d.ndx,d.parent.childNodes.length-1);if(h.parent.childNodes[h.ndx].nodeType&&h.parent.childNodes[h.ndx].nodeType==1){this.setStart(h.parent,h.ndx)}else{this.setStart(h.parent.childNodes[h.ndx],h.offset)}if(d.parent.childNodes[d.ndx].nodeType&&d.parent.childNodes[d.ndx].nodeType==1){this.setEnd(d.parent,d.ndx)}else{this.setEnd(d.parent.childNodes[d.ndx],d.offset)}this.select()}return this};this.isCollapsed=function(){this.range();this.collapsed=this.r.item?false:this.r.boundingWidth==0;return this.collapsed};this.collapse=function(d){this.range();if(this.r.item){var f=this.r.item(0);this.r=this.rte.doc.body.createTextRange();this.r.moveToElementText(f)}this.r.collapse(d);this.r.select();this.collapsed=true};this.getStart=function(){this.range();if(this.r.item){return this.r.item(0)}var f=this.r.duplicate();f.collapse(true);var d=f.parentElement();return d&&d.nodeName=="BODY"?d.firstChild:d};this.getEnd=function(){this.range();if(this.r.item){return this.r.item(0)}var d=this.r.duplicate();d.collapse(false);var f=d.parentElement();return f&&f.nodeName=="BODY"?f.lastChild:f};this.setStart=function(d,f){this.startContainer=d;this.startOffset=f;if(this.endContainer){this.commonAncestorContainer=this.rte.dom.findCommonAncestor(this.startContainer,this.endContainer)}};this.setEnd=function(d,f){this.endContainer=d;this.endOffset=f;if(this.startContainer){this.commonAncestorContainer=this.rte.dom.findCommonAncestor(this.startContainer,this.endContainer)}};this.setStartBefore=function(d){if(d.parentNode){this.setStart(d.parentNode,this.rte.dom.indexOf(d))}};this.setStartAfter=function(d){if(d.parentNode){this.setStart(d.parentNode,this.rte.dom.indexOf(d)+1)}};this.setEndBefore=function(d){if(d.parentNode){this.setEnd(d.parentNode,this.rte.dom.indexOf(d))}};this.setEndAfter=function(d){if(d.parentNode){this.setEnd(d.parentNode,this.rte.dom.indexOf(d)+1)}};this.select=function(){function k(A,x){if(A.nodeType!=3){return -1}var z="\uFEFF";var w=A.nodeValue;var u=b.rte.doc.body.createTextRange();A.nodeValue=w.substring(0,x)+z+w.substring(x);u.moveToElementText(A.parentNode);u.findText(z);var v=Math.abs(u.moveStart("character",-1048575));A.nodeValue=w;return v}this.r=this.rte.doc.body.createTextRange();var j=this.startOffset;var f=this.endOffset;var t=this.startContainer.nodeType==1?this.startContainer.childNodes[Math.min(j,this.startContainer.childNodes.length-1)]:this.startContainer;var o=this.endContainer.nodeType==1?this.endContainer.childNodes[Math.min(j==f?f:f-1,this.endContainer.childNodes.length-1)]:this.endContainer;if(this.collapsed){if(t.nodeType==3){var g=k(t,j);this.r.move("character",g)}else{this.r.moveToElementText(t);this.r.collapse(true)}}else{var d=this.rte.doc.body.createTextRange();var h=k(t,j);var q=k(o,f);if(t.nodeType==3){this.r.move("character",h)}else{this.r.moveToElementText(t)}if(o.nodeType==3){d.move("character",q)}else{d.moveToElementText(o)}this.r.setEndPoint("EndToEnd",d)}try{this.r.select()}catch(o){}if(d){d=null}};this.dump=function(){this.rte.log("collapsed: "+this.collapsed);this.rte.log("startContainer: "+(this.startContainer?this.startContainer.nodeName:"non"));this.rte.log("startOffset: "+this.startOffset);this.rte.log("endContainer: "+(this.endContainer?this.endContainer.nodeName:"none"));this.rte.log("endOffset: "+this.endOffset)}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.anchor=function(d,c){this.constructor.prototype.constructor.call(this,d,c);this.input=a('<input type="text" />').attr("name","anchor").attr("size","16");var b=this;this.command=function(){var f={submit:function(h,j){h.stopPropagation();h.preventDefault();j.close();b.set()},dialog:{title:this.rte.i18n("Bookmark")}};this.anchor=this.rte.dom.selfOrParentAnchor(this.rte.selection.getEnd())||d.dom.create("a");!this.rte.selection.collapsed()&&this.rte.selection.collapse(false);this.input.val(a(this.anchor).addClass("el-rte-anchor").attr("name"));this.rte.selection.saveIERange();var g=new elDialogForm(f);g.append([this.rte.i18n("Bookmark name"),this.input],null,true).open()};this.update=function(){var f=this.rte.selection.getNode();if(this.rte.dom.selfOrParentLink(f)){this.domElem.addClass("disabled")}else{if(this.rte.dom.selfOrParentAnchor(f)){this.domElem.removeClass("disabled").addClass("active")}else{this.domElem.removeClass("disabled").removeClass("active")}}};this.set=function(){var f=a.trim(this.input.val());this.rte.selection.restoreIERange();if(f){this.rte.history.add();if(!this.anchor.parentNode){this.rte.selection.insertHtml('<a name="'+f+'" title="'+this.rte.i18n("Bookmark")+": "+f+'" class="el-rte-anchor"></a>')}else{this.anchor.name=f;this.anchor.title=this.rte.i18n("Bookmark")+": "+f}}else{if(this.anchor.parentNode){this.rte.history.add();this.anchor.parentNode.removeChild(this.anchor)}}}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.blockquote=function(c,b){this.constructor.prototype.constructor.call(this,c,b);this.command=function(){var f,d;if(this.rte.selection.collapsed()&&(f=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^BLOCKQUOTE$/))){a(f).replaceWith(a(f).html())}else{d=this.rte.selection.selected({wrap:"all",tag:"blockquote"});d.length&&this.rte.selection.select(d[0],d[d.length-1])}this.rte.ui.update(true)};this.update=function(){if(this.rte.selection.collapsed()){if(this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^BLOCKQUOTE$/)){this.domElem.removeClass("disabled").addClass("active")}else{this.domElem.addClass("disabled").removeClass("active")}}else{this.domElem.removeClass("disabled").removeClass("active")}}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.copy=function(c,b){this.constructor.prototype.constructor.call(this,c,b);this.command=function(){if(this.rte.browser.mozilla){try{this.rte.doc.execCommand(this.name,false,null)}catch(h){var f=" Ctl + C";if(this.name=="cut"){f=" Ctl + X"}else{if(this.name=="paste"){f=" Ctl + V"}}var g={dialog:{title:this.rte.i18n("Warning"),buttons:{Ok:function(){a(this).dialog("close")}}}};var j=new elDialogForm(g);j.append(this.rte.i18n("This operation is disabled in your browser on security reason. Use shortcut instead.")+": "+f).open()}}else{this.constructor.prototype.command.call(this)}}};elRTE.prototype.ui.prototype.buttons.cut=elRTE.prototype.ui.prototype.buttons.copy;elRTE.prototype.ui.prototype.buttons.paste=elRTE.prototype.ui.prototype.buttons.copy})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.div=function(c,b){this.constructor.prototype.constructor.call(this,c,b);this.command=function(){var f,d;this.rte.history.add();if(this.rte.selection.collapsed()&&(f=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^DIV$/))){a(f).replaceWith(a(f).html())}else{d=this.rte.selection.selected({wrap:"all",tag:"div"});d.length&&this.rte.selection.select(d[0],d[d.length-1])}this.rte.ui.update(true)};this.update=function(){if(this.rte.selection.collapsed()){if(this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^DIV$/)){this.domElem.removeClass("disabled").addClass("active")}else{this.domElem.addClass("disabled").removeClass("active")}}else{this.domElem.removeClass("disabled").removeClass("active")}}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.docstructure=function(c,b){this.constructor.prototype.constructor.call(this,c,b);this.command=function(){this.domElem.toggleClass("active");a(this.rte.doc.body).toggleClass("el-rte-structure")};this.command();this.update=function(){this.domElem.removeClass("disabled")}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.elfinder=function(d,c){this.constructor.prototype.constructor.call(this,d,c);var b=this;this.command=function(){if(b.rte.options.fmAllow&&typeof(b.rte.options.fmOpen)=="function"){b.rte.options.fmOpen(function(f){b.rte.log(f)})}};this.update=function(){if(b.rte.options.fmAllow&&typeof(b.rte.options.fmOpen)=="function"){this.domElem.removeClass("disabled")}else{this.domElem.addClass("disabled")}}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.fontname=function(d,c){this.constructor.prototype.constructor.call(this,d,c);var b=this;var f={tpl:'<span style="font-family:%val">%label</span>',select:function(g){b.set(g)},src:{"":this.rte.i18n("Font"),"andale mono,sans-serif":"Andale Mono","arial,helvetica,sans-serif":"Arial","arial black,gadget,sans-serif":"Arial Black","book antiqua,palatino,sans-serif":"Book Antiqua","comic sans ms,cursive":"Comic Sans MS","courier new,courier,monospace":"Courier New","georgia,palatino,serif":"Georgia","helvetica,sans-serif":"Helvetica","impact,sans-serif":"Impact","lucida console,monaco,monospace":"Lucida console","lucida sans unicode,lucida grande,sans-serif":"Lucida grande","tahoma,sans-serif":"Tahoma","times new roman,times,serif":"Times New Roman","trebuchet ms,lucida grande,verdana,sans-serif":"Trebuchet MS","verdana,geneva,sans-serif":"Verdana"}};this.select=this.domElem.elSelect(f);this.command=function(){};this.set=function(h){this.rte.history.add();var g=this.rte.selection.selected({filter:"textContainsNodes"});a.each(g,function(){$this=/^(THEAD|TFOOT|TBODY|COL|COLGROUP|TR)$/.test(this.nodeName)?a(this).find("td,th"):a(this);a(this).css("font-family",h).find("[style]").css("font-family","")});this.rte.ui.update()};this.update=function(){this.domElem.removeClass("disabled");var h=this.rte.selection.getNode();if(h.nodeType!=1){h=h.parentNode}var g=a(h).css("font-family");g=g?g.toString().toLowerCase().replace(/,\s+/g,",").replace(/'|"/g,""):"";this.select.val(f.src[g]?g:"")}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.fontsize=function(d,c){this.constructor.prototype.constructor.call(this,d,c);var b=this;var f={labelTpl:"%label",tpl:'<span style="font-size:%val;line-height:1.2em">%label</span>',select:function(g){b.set(g)},src:{"":this.rte.i18n("Font size"),"xx-small":this.rte.i18n("Small (8pt)"),"x-small":this.rte.i18n("Small (10px)"),small:this.rte.i18n("Small (12pt)"),medium:this.rte.i18n("Normal (14pt)"),large:this.rte.i18n("Large (18pt)"),"x-large":this.rte.i18n("Large (24pt)"),"xx-large":this.rte.i18n("Large (36pt)")}};this.select=this.domElem.elSelect(f);this.command=function(){};this.set=function(h){this.rte.history.add();var g=this.rte.selection.selected({filter:"textContainsNodes"});a.each(g,function(){$this=/^(THEAD|TFOOT|TBODY|COL|COLGROUP|TR)$/.test(this.nodeName)?a(this).find("td,th"):a(this);$this.css("font-size",h).find("[style]").css("font-size","")});this.rte.ui.update()};this.update=function(){this.domElem.removeClass("disabled");var g=this.rte.selection.getNode();this.select.val((m=this.rte.dom.attr(g,"style").match(/font-size:\s*([^;]+)/i))?m[1]:"")}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.forecolor=function(d,c){var b=this;this.constructor.prototype.constructor.call(this,d,c);var f={"class":"",color:this.defaultColor,update:function(g){b.indicator.css("background-color",g)},change:function(g){b.set(g)}};this.defaultColor=this.rte.utils.rgb2hex(a(this.rte.doc.body).css(this.name=="forecolor"?"color":"background-color"));this.picker=this.domElem.elColorPicker(f);this.indicator=a("<div />").addClass("color-indicator").prependTo(this.domElem);this.command=function(){};this.set=function(j){if(!this.rte.selection.collapsed()){this.rte.history.add();var g=this.rte.selection.selected({collapse:false,wrap:"text"}),h=this.name=="forecolor"?"color":"background-color";a.each(g,function(){if(/^(THEAD|TBODY|TFOOT|TR)$/.test(this.nodeName)){a(this).find("td,th").each(function(){a(this).css(h,j).find("*").css(h,"")})}else{a(this).css(h,j).find("*").css(h,"")}});this.rte.ui.update(true)}};this.update=function(){this.domElem.removeClass("disabled");var h=this.rte.selection.getNode();if(h.nodeType!=1){h=h.parentNode}var g=a(h).css(this.name=="forecolor"?"color":"background-color");this.picker.val(g&&g!="transparent"?this.rte.utils.rgb2hex(g):this.defaultColor)}};elRTE.prototype.ui.prototype.buttons.hilitecolor=elRTE.prototype.ui.prototype.buttons.forecolor})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.formatblock=function(d,c){this.constructor.prototype.constructor.call(this,d,c);var g=this.rte.browser.msie?function(h){b.val=h;b.constructor.prototype.command.call(b)}:function(h){b.ieCommand(h)};var b=this;var f={labelTpl:"%label",tpls:{"":"%label"},select:function(h){b.formatBlock(h)},src:{span:this.rte.i18n("Format"),h1:this.rte.i18n("Heading 1"),h2:this.rte.i18n("Heading 2"),h3:this.rte.i18n("Heading 3"),h4:this.rte.i18n("Heading 4"),h5:this.rte.i18n("Heading 5"),h6:this.rte.i18n("Heading 6"),p:this.rte.i18n("Paragraph"),address:this.rte.i18n("Address"),pre:this.rte.i18n("Preformatted"),div:this.rte.i18n("Normal (DIV)")}};this.select=this.domElem.elSelect(f);this.command=function(){};this.formatBlock=function(k){function q(w,u){function v(x){a(x).find("h1,h2,h3,h4,h5,h6,p,address,pre").each(function(){a(this).replaceWith(a(this).html())});return x}if(/^(LI|DT|DD|TD|TH|CAPTION)$/.test(w.nodeName)){!b.rte.dom.isEmpty(w)&&b.rte.dom.wrapContents(v(w),u)}else{if(/^(UL|OL|DL|TABLE)$/.test(w.nodeName)){b.rte.dom.wrap(w,u)}else{!b.rte.dom.isEmpty(w)&&a(v(w)).replaceWith(a(b.rte.dom.create(u)).html(a(w).html()))}}}this.rte.history.add();var h=k.toUpperCase(),o,t,p,r=this.rte.selection.collapsed(),j=this.rte.selection.selected({collapsed:true,blocks:true,filter:"textContainsNodes",wrap:"inline",tag:"span"});l=j.length,s=a(this.rte.dom.create("span")).insertBefore(j[0]),e=a(this.rte.dom.create("span")).insertAfter(j[j.length-1]);while(l--){t=j[l];p=a(t);if(h=="DIV"||h=="SPAN"){if(/^(H[1-6]|P|ADDRESS|PRE)$/.test(t.nodeName)){p.replaceWith(a(this.rte.dom.create("div")).html(p.html()||""))}}else{if(/^(THEAD|TBODY|TFOOT|TR)$/.test(t.nodeName)){p.find("td,th").each(function(){q(this,h)})}else{if(t.nodeName!=h){q(t,h)}}}}b.rte.selection.select(s.next()[0],e.prev()[0]);s.add(e).remove();r&&b.rte.selection.collapse(true);this.rte.ui.update(true)};this.update=function(){this.domElem.removeClass("disabled");var h=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(H[1-6]|P|ADDRESS|PRE)$/);this.select.val(h?h.nodeName.toLowerCase():"span")}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.fullscreen=function(d,c){this.constructor.prototype.constructor.call(this,d,c);this.active=true;this.parents=[];this.height=0;var b=this;this.command=function(){if(this.rte.editor.hasClass("el-fullscreen")){for(var f=0;f<this.parents.length;f++){a(this.parents[f]).css("position","relative")}this.parents=[];this.rte.editor.removeClass("el-fullscreen");this.rte.workzone.height(this.height);this.domElem.removeClass("active")}else{this.parents=[];var j=this.rte.editor.parents().each(function(){if(this.nodeName!="BODY"&&this.name!="HTML"&&a(this).css("position")=="relative"){b.parents.push(this);a(this).css("position","static")}});this.height=this.rte.workzone.height();this.rte.editor.addClass("el-fullscreen");var g=parseInt(this.rte.editor.height()-this.rte.toolbar.height()-this.rte.statusbar.height()-this.rte.tabsbar.height()-17);g>0&&this.rte.workzone.height(g);this.domElem.addClass("active")}};this.update=function(){this.domElem.removeClass("disabled")}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.horizontalrule=function(d,c){this.constructor.prototype.constructor.call(this,d,c);var b=this;this.src={width:a('<input type="text" />').attr({name:"width",size:4}).css("text-align","right"),wunit:a("<select />").attr("name","wunit").append(a("<option />").val("%").text("%")).append(a("<option />").val("px").text("px")).val("%"),height:a('<input type="text" />').attr({name:"height",size:4}).css("text-align","right"),bg:a("<div />"),border:a("<div />"),"class":a('<input type="text" />').css("width","100%"),style:a('<input type="text" />').css("width","100%")};this.command=function(){this.src.bg.elColorPicker({palettePosition:"outer","class":"el-colorpicker ui-icon ui-icon-pencil"});var j=this.rte.selection.getEnd();this.hr=j.nodeName=="HR"?a(j):a(d.doc.createElement("hr")).css({width:"100%",height:"1px"});this.src.border.elBorderSelect({styleHeight:73,value:this.hr});var f=this.hr.css("width")||this.hr.attr("width");this.src.width.val(parseInt(f)||100);this.src.wunit.val(f.indexOf("px")!=-1?"px":"%");this.src.height.val(this.rte.utils.toPixels(this.hr.css("height")||this.hr.attr("height"))||1);this.src.bg.val(this.rte.utils.rgb2hex(this.hr.css("background-color"))||"");this.src["class"].val(this.rte.dom.attr(this.hr,"class"));this.src.style.val(this.rte.dom.attr(this.hr,"style"));var g={submit:function(k,o){k.stopPropagation();k.preventDefault();b.set();o.close()},dialog:{title:this.rte.i18n("Horizontal rule")}};var h=new elDialogForm(g);h.append([this.rte.i18n("Width"),a("<span />").append(this.src.width).append(this.src.wunit)],null,true).append([this.rte.i18n("Height"),a("<span />").append(this.src.height).append(" px")],null,true).append([this.rte.i18n("Border"),this.src.border],null,true).append([this.rte.i18n("Background"),this.src.bg],null,true).append([this.rte.i18n("Css class"),this.src["class"]],null,true).append([this.rte.i18n("Css style"),this.src.style],null,true).open()};this.update=function(){this.domElem.removeClass("disabled");if(this.rte.selection.getEnd().nodeName=="HR"){this.domElem.addClass("active")}else{this.domElem.removeClass("active")}};this.set=function(){this.rte.history.add();!this.hr.parentNode&&this.rte.selection.insertNode(this.hr.get(0));var g={noshade:true,style:this.src.style.val()};var f=this.src.border.val();var h={width:(parseInt(this.src.width.val())||100)+this.src.wunit.val(),height:parseInt(this.src.height.val())||1,"background-color":this.src.bg.val(),border:f.width&&f.style?f.width+" "+f.style+" "+f.color:""};this.hr.removeAttr("class").removeAttr("style").removeAttr("width").removeAttr("height").removeAttr("align").attr(g).css(h);if(this.src["class"].val()){this.hr.attr("class",this.src["class"].val())}this.rte.ui.update()}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.image=function(d,c){this.constructor.prototype.constructor.call(this,d,c);var b=this;this.img=null;this.init=function(){this.labels={main:"Properies",link:"Link",adv:"Advanced",events:"Events",id:"ID","class":"Css class",style:"Css style",longdesc:"Detail description URL",href:"URL",target:"Open in",title:"Title"};this.src={main:{src:a('<input type="text" />').css("width","100%"),title:a('<input type="text" />').css("width","100%"),alt:a('<input type="text" />').css("width","100%"),width:a('<input type="text" />').attr("size",5).css("text-align","right"),height:a('<input type="text" />').attr("size",5).css("text-align","right"),margin:a("<div />"),align:a("<select />").css("width","100%").append(a("<option />").val("").text(this.rte.i18n("Not set","dialogs"))).append(a("<option />").val("left").text(this.rte.i18n("Left"))).append(a("<option />").val("right").text(this.rte.i18n("Right"))).append(a("<option />").val("top").text(this.rte.i18n("Top"))).append(a("<option />").val("text-top").text(this.rte.i18n("Text top"))).append(a("<option />").val("middle").text(this.rte.i18n("middle"))).append(a("<option />").val("baseline").text(this.rte.i18n("Baseline"))).append(a("<option />").val("bottom").text(this.rte.i18n("Bottom"))).append(a("<option />").val("text-bottom").text(this.rte.i18n("Text bottom"))),border:a("<div />")},adv:{id:a('<input type="text" />').css("width","100%"),"class":a('<input type="text" />').css("width","100%"),style:a('<input type="text" />').css("width","100%"),longdesc:a('<input type="text" />').css("width","100%")},events:{}};a.each(["onblur","onfocus","onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmouseout","onmouseleave","onkeydown","onkeypress","onkeyup"],function(){b.src.events[this]=a('<input type="text" />').css("width","100%")});a.each(b.src,function(){for(var f in this){this[f].attr("name",f)}})};this.command=function(){!this.src&&this.init();this.rte.browser.msie&&this.rte.selection.saveIERange();this.src.main.border.elBorderSelect({change:function(){b.updateImg()},name:"border"});this.src.main.margin.elPaddingInput({type:"margin"});this.cleanValues();this.src.main.src.val("");var k=this.rte.selection.getEnd();this.preview=null;this.prevImg=null;this.link=null;if(k.nodeName=="IMG"){this.img=a(k)}else{this.img=a(this.rte.doc.createElement("img"))}var g={submit:function(u,v){u.stopPropagation();u.preventDefault();b.set();v.close()},dialog:{width:520,position:"top",title:this.rte.i18n("Image")}};var r=new elDialogForm(g);if(this.rte.options.fmAllow&&this.rte.options.fmOpen){var f=a("<span />").append(this.src.main.src.css("width","88%")).append(a("<span />").addClass("ui-state-default ui-corner-all").css({"float":"right","margin-right":"3px"}).attr("title",b.rte.i18n("Open file manger")).append(a("<span />").addClass("ui-icon ui-icon-folder-open")).click(function(){b.rte.options.fmOpen(function(u){b.src.main.src.val(u).change()})}).hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}))}else{var f=this.src.main.src}r.tab("main",this.rte.i18n("Properies")).append([this.rte.i18n("Image URL"),f],"main",true).append([this.rte.i18n("Title"),this.src.main.title],"main",true).append([this.rte.i18n("Alt text"),this.src.main.alt],"main",true).append([this.rte.i18n("Size"),a("<span />").append(this.src.main.width).append(" x ").append(this.src.main.height).append(" px")],"main",true).append([this.rte.i18n("Alignment"),this.src.main.align],"main",true).append([this.rte.i18n("Margins"),this.src.main.margin],"main",true).append([this.rte.i18n("Border"),this.src.main.border],"main",true);for(var o in this.src){if(o!="main"){r.tab(o,this.rte.i18n(this.labels[o]));for(var h in this.src[o]){var p=this.rte.i18n(this.labels[h]?this.labels[h]:h);if(o=="events"){this.src[o][h].val(this.rte.utils.trimEventCallback(this.img.attr(h)))}else{if(o=="link"){if(this.link){this.src[o][h].val(h=="href"?this.rte.utils.absoluteURL(this.link.attr(h)):this.link.attr(h))}}else{this.src[o][h].val(this.img.attr(h)||"")}}r.append([p,this.src[o][h]],o,true)}}}r.open();var q=a("<fieldset />").append(a("<legend />").text(this.rte.i18n("Preview")));r.append(q,"main");var j=document.createElement("iframe");a(j).attr("src","#").addClass("el-rte-preview").appendTo(q);html=this.rte.options.doctype+'<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /></head><body style="padding:0;margin:0;font-size:9px"> </body></html>';j.contentWindow.document.open();j.contentWindow.document.write(html);j.contentWindow.document.close();this.frame=j.contentWindow.document;this.preview=a(j.contentWindow.document.body).text("Proin elit arcu, rutrum commodo, vehicula tempus, commodo a, risus. Curabitur nec arcu. Donec sollicitudin mi sit amet mauris. Nam elementum quam ullamcorper ante. Etiam aliquet massa et lorem. Mauris dapibus lacus auctor risus. Aenean tempor ullamcorper leo. Vivamus sed magna quis ligula eleifend adipiscing. Duis orci. Aliquam sodales tortor vitae ipsum. Aliquam nulla. Duis aliquam molestie erat. Ut et mauris vel pede varius sollicitudin");if(this.img.attr("src")){this.prevImg=a(this.frame.createElement("img")).attr("src",this.rte.utils.absoluteURL(this.img.attr("src")));this.prevImg.attr("width",this.img.attr("width")).attr("height",this.img.attr("height")).attr("title",this.img.attr("title")||"").attr("alt",this.img.attr("alt")||"").attr("style",this.img.attr("style")||"");for(var k in this.src.adv){var t=this.img.attr(k);if(t){this.prevImg.attr(k,t)}}this.preview.prepend(this.prevImg);this.updateValues()}a.each(this.src,function(){a.each(this,function(){if(this===b.src.main.src){this.bind("change",function(){b.updatePreview()})}else{if(this==b.src.main.width||this==b.src.main.height){this.bind("change",function(u){b.updateDimesions(u)})}else{this.bind("change",function(){b.updateImg()})}}})})};this.updateValues=function(){var g=this.prevImg.get(0);this.origW=this.prevImg.attr("width");this.origH=this.prevImg.attr("height");this.src.main.src.val(this.rte.dom.attr(g,"src"));this.src.main.title.val(this.rte.dom.attr(g,"title"));this.src.main.alt.val(this.rte.dom.attr(g,"alt"));this.src.main.width.val(this.origW);this.src.main.height.val(this.origH);this.src.adv["class"].val(this.rte.dom.attr(g,"class"));this.src.main.margin.val(this.prevImg);var h=this.prevImg.css("float");this.src.main.align.val(h=="left"||h=="right"?h:(this.prevImg.css("vertical-align")||""));this.src.main.border.val(this.prevImg);this.src.adv.style.val(this.rte.dom.attr(g,"style"))};this.cleanValues=function(){a.each(this.src,function(){a.each(this,function(){var f=a(this);if(f.attr("name")!="src"){f.val("")}})})};this.updateImg=function(){this.prevImg.attr({style:a.trim(this.src.adv.style.val()),title:a.trim(this.src.main.title.val()),alt:a.trim(this.src.main.alt.val()),width:parseInt(this.src.main.width.val()),height:parseInt(this.src.main.height.val())});var j=this.src.main.align.val();var k=j=="left"||j=="right"?j:"";var h=this.src.main.border.val();var g=this.src.main.margin.val();this.prevImg.css("float",k);this.prevImg.css("vertical-align",k?"":j);this.prevImg.css("border",a.trim(h.width+" "+h.style+" "+h.color));if(g.css){this.prevImg.css("margin",g.css)}else{this.prevImg.css("margin-top",g.top);this.prevImg.css("margin-right",g.right);this.prevImg.css("margin-bottom",g.bottom);this.prevImg.css("margin-left",g.left)}a.each([this.src.events,this.src.adv],function(){a.each(this,function(){var o=a(this);var p=o.attr("name");if(p!="style"){var f=a.trim(o.val());if(f){b.prevImg.attr(p,f)}else{b.prevImg.removeAttr(p)}}})})};this.updatePreview=function(){var g=this.prevImg?this.prevImg.attr("src"):"";var f=a.trim(this.src.main.src.val());if(!f||f!=g){if(this.prevImg){this.prevImg.remove();this.prevImg=null}this.cleanValues();if(f){this.prevImg=a(this.frame.createElement("img")).attr("src",this.rte.utils.absoluteURL(f)).bind("load",function(){b.updateValues()});this.preview.prepend(this.prevImg);b.updateValues()}}else{this.updateImg()}};this.updateDimesions=function(j){var f=parseInt(this.src.main.width.val())||0;var g=parseInt(this.src.main.height.val())||0;if(f>0&&g>0){if(j.currentTarget==this.src.main.width.get(0)){this.src.main.height.val(parseInt(f*this.origH/this.origW))}else{this.src.main.width.val(parseInt(g*this.origW/this.origH))}}else{this.src.main.width.val(this.origW);this.src.main.height.val(this.origH)}this.updateImg()};this.set=function(){this.rte.history.add();if(!this.prevImg||!this.prevImg.attr("width")){this.img&&this.img.remove();this.link&&this.rte.doc.execCommand("unlink",false,null)}else{if(!this.img.parents().length){this.rte.browser.msie&&this.rte.selection.restoreIERange();this.img=a(this.rte.doc.createElement("img"))}this.img.attr({src:this.rte.utils.absoluteURL(a.trim(this.src.main.src.val())),style:a.trim(this.rte.dom.attr(this.prevImg.get(0),"style")),title:a.trim(this.src.main.title.val()),alt:a.trim(this.src.main.alt.val()),width:parseInt(this.src.main.width.val()),height:parseInt(this.src.main.height.val())});for(var f in this.src.adv){if(f!="style"){var g=this.src.adv[f].val();if(g){this.img.attr(f,g)}else{this.img.removeAttr(f)}}}for(var f in this.src.events){var g=this.src.events[f].val();if(g){this.img.attr(f,g)}else{this.img.removeAttr(f)}}if(!this.img.parents().length){this.rte.selection.insertNode(this.img.get(0))}}this.rte.ui.update()};this.update=function(){this.domElem.removeClass("disabled");var f=this.rte.selection.getEnd();if(f.nodeName=="IMG"){this.domElem.addClass("active")}else{this.domElem.removeClass("active")}}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.indent=function(d,c){this.constructor.prototype.constructor.call(this,d,c);var b=this;this.command=function(){this.rte.history.add();var g=this.rte.selection.selected({collapsed:true,blocks:true,wrap:"inline",tag:"p"});function f(p){var k=/(IMG|HR|TABLE|EMBED|OBJECT)/.test(p.nodeName)?"margin-left":"padding-left";var o=b.rte.dom.attr(p,"style").indexOf(k)!=-1?parseInt(a(p).css(k))||0:0;a(p).css(k,o+40+"px")}for(var h=0;h<g.length;h++){if(/^(TABLE|THEAD|TFOOT|TBODY|COL|COLGROUP|TR)$/.test(g[h].nodeName)){a(g[h]).find("td,th").each(function(){f(this)})}else{if(/^LI$/.test(g[h].nodeName)){var j=a(g[h]);a(this.rte.dom.create(g[h].parentNode.nodeName)).append(a(this.rte.dom.create("li")).html(j.html()||"")).appendTo(j.html("&nbsp;"))}else{f(g[h])}}}this.rte.ui.update()};this.update=function(){this.domElem.removeClass("disabled")}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.justifyleft=function(c,b){this.constructor.prototype.constructor.call(this,c,b);this.align=this.name=="justifyfull"?"justify":this.name.replace("justify","");this.command=function(){var f=this.rte.selection.selected({collapsed:true,blocks:true,tag:"div"}),d=f.length;d&&this.rte.history.add();while(d--){this.rte.dom.filter(f[d],"textNodes")&&a(f[d]).css("text-align",this.align)}this.rte.ui.update()};this.update=function(){var d=this.rte.selection.getNode(),f=d.nodeName=="BODY"?d:this.rte.dom.selfOrParent(d,"textNodes")||(d.parentNode&&d.parentNode.nodeName=="BODY"?d.parentNode:null);if(f){this.domElem.removeClass("disabled").toggleClass("active",a(f).css("text-align")==this.align)}else{this.domElem.addClass("disabled")}}};elRTE.prototype.ui.prototype.buttons.justifycenter=elRTE.prototype.ui.prototype.buttons.justifyleft;elRTE.prototype.ui.prototype.buttons.justifyright=elRTE.prototype.ui.prototype.buttons.justifyleft;elRTE.prototype.ui.prototype.buttons.justifyfull=elRTE.prototype.ui.prototype.buttons.justifyleft})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.link=function(d,c){this.constructor.prototype.constructor.call(this,d,c);var b=this;function f(){b.labels={id:"ID","class":"Css class",style:"Css style",dir:"Script direction",lang:"Language",charset:"Charset",type:"Target MIME type",rel:"Relationship page to target (rel)",rev:"Relationship target to page (rev)",tabindex:"Tab index",accesskey:"Access key"};b.src={main:{href:a('<input type="text" />'),title:a('<input type="text" />'),anchor:a("<select />").attr("name","anchor")},popup:{use:a('<input type="checkbox />"'),url:a('<input type="text" />').val("http://"),name:a('<input type="text" />'),width:a('<input type="text" />').attr({size:6,title:b.rte.i18n("Width")}).css("text-align","right"),height:a('<input type="text" />').attr({size:6,title:b.rte.i18n("Height")}).css("text-align","right"),left:a('<input type="text" />').attr({size:6,title:b.rte.i18n("Left")}).css("text-align","right"),top:a('<input type="text" />').attr({size:6,title:b.rte.i18n("Top")}).css("text-align","right"),location:a('<input type="checkbox" />'),menubar:a('<input type="checkbox" />'),toolbar:a('<input type="checkbox" />'),scrollbars:a('<input type="checkbox" />'),status:a('<input type="checkbox" />'),resizable:a('<input type="checkbox" />'),dependent:a('<input type="checkbox" />'),retfalse:a('<input type="checkbox" />').attr("checked",true)},adv:{id:a('<input type="text" />'),"class":a('<input type="text" />'),style:a('<input type="text" />'),dir:a("<select />").append(a("<option />").text(b.rte.i18n("Not set")).val("")).append(a("<option />").text(b.rte.i18n("Left to right")).val("ltr")).append(a("<option />").text(b.rte.i18n("Right to left")).val("rtl")),lang:a('<input type="text" />'),charset:a('<input type="text" />'),type:a('<input type="text" />'),rel:a('<input type="text" />'),rev:a('<input type="text" />'),tabindex:a('<input type="text" />'),accesskey:a('<input type="text" />')},events:{}};a.each(["onblur","onfocus","onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmouseout","onmouseleave","onkeydown","onkeypress","onkeyup"],function(){b.src.events[this]=a('<input type="text" />')});a.each(b.src,function(){for(var h in this){this[h].attr("name",h);var g=this[h].attr("type");if(!g||(g=="text"&&!this[h].attr("size"))){this[h].css("width","100%")}}})}this.command=function(){!this.src&&f();this.rte.browser.msie&&this.rte.selection.saveIERange();var k=this.rte.selection.getNode();var o;if((o=this.rte.dom.selfOrParentLink(k))){this.link=o}else{if((o=this.rte.dom.childLinks(k))){this.link=o[0]}}this.link=this.link?a(this.link):a(this.rte.doc.createElement("a"));this.updatePopup();this.src.main.anchor.empty();a('a[href!=""][name]',this.rte.doc).each(function(){var r=a(this).attr("name");b.src.main.anchor.append(a("<option />").val(r).text(r))});if(this.src.main.anchor.children().length){this.src.main.anchor.prepend(a("<option />").val("").text(this.rte.i18n("Select bookmark"))).change(function(){var r=a(this).val();if(r){b.src.main.href.val("#"+r)}})}var g={submit:function(r,v){r.stopPropagation();r.preventDefault();b.set();v.close()},tabs:{show:function(v,r){if(r.index==3){b.updateOnclick()}}},dialog:{width:"auto",width:430,title:this.rte.i18n("Link")}};var p=new elDialogForm(g);var o=a("<div />").append(a("<label />").append(this.src.popup.location).append(this.rte.i18n("Location bar"))).append(a("<label />").append(this.src.popup.menubar).append(this.rte.i18n("Menu bar"))).append(a("<label />").append(this.src.popup.toolbar).append(this.rte.i18n("Toolbar"))).append(a("<label />").append(this.src.popup.scrollbars).append(this.rte.i18n("Scrollbars")));var h=a("<div />").append(a("<label />").append(this.src.popup.status).append(this.rte.i18n("Status bar"))).append(a("<label />").append(this.src.popup.resizable).append(this.rte.i18n("Resizable"))).append(a("<label />").append(this.src.popup.dependent).append(this.rte.i18n("Depedent"))).append(a("<label />").append(this.src.popup.retfalse).append(this.rte.i18n("Add return false")));p.tab("main",this.rte.i18n("Properies")).tab("popup",this.rte.i18n("Popup")).tab("adv",this.rte.i18n("Advanced")).tab("events",this.rte.i18n("Events")).append(a("<label />").append(this.src.popup.use).append(this.rte.i18n("Open link in popup window")),"popup").separator("popup").append([this.rte.i18n("URL"),this.src.popup.url],"popup",true).append([this.rte.i18n("Window name"),this.src.popup.name],"popup",true).append([this.rte.i18n("Window size"),a("<span />").append(this.src.popup.width).append(" x ").append(this.src.popup.height).append(" px")],"popup",true).append([this.rte.i18n("Window position"),a("<span />").append(this.src.popup.left).append(" x ").append(this.src.popup.top).append(" px")],"popup",true).separator("popup").append([o,h],"popup",true);var q=this.link.get(0);var j=this.rte.dom.attr(q,"href");this.src.main.href.val(j).change(function(){a(this).val(b.rte.utils.absoluteURL(a(this).val()))});if(this.rte.options.fmAllow&&this.rte.options.fmOpen){var u=a("<span />").append(this.src.main.href.css("width","87%")).append(a("<span />").addClass("ui-state-default ui-corner-all").css({"float":"right","margin-right":"3px"}).attr("title",b.rte.i18n("Open file manger")).append(a("<span />").addClass("ui-icon ui-icon-folder-open")).click(function(){b.rte.options.fmOpen(function(r){b.src.main.href.val(r).change()})}).hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}));p.append([this.rte.i18n("Link URL"),u],"main",true)}else{p.append([this.rte.i18n("Link URL"),this.src.main.href],"main",true)}this.src.main.href.change();p.append([this.rte.i18n("Title"),this.src.main.title.val(this.rte.dom.attr(q,"title"))],"main",true);if(this.src.main.anchor.children().length){p.append([this.rte.i18n("Bookmark"),this.src.main.anchor.val(j)],"main",true)}for(var k in this.src.adv){this.src.adv[k].val(this.rte.dom.attr(q,k));p.append([this.rte.i18n(this.labels[k]?this.labels[k]:k),this.src.adv[k]],"adv",true)}for(var k in this.src.events){var t=this.rte.utils.trimEventCallback(this.rte.dom.attr(q,k));this.src.events[k].val(t);p.append([this.rte.i18n(this.labels[k]?this.labels[k]:k),this.src.events[k]],"events",true)}this.src.popup.use.change(function(){var r=a(this).attr("checked");a.each(b.src.popup,function(){if(a(this).attr("name")!="use"){if(r){a(this).removeAttr("disabled")}else{a(this).attr("disabled",true)}}})});this.src.popup.use.change();p.open()};this.update=function(){var g=this.rte.selection.getNode();if(this.rte.dom.selfOrParentAnchor(g)){this.domElem.addClass("disabled")}else{if(this.rte.dom.selfOrParentLink(g)||this.rte.dom.childLinks(g).length){this.domElem.removeClass("disabled").addClass("active")}else{this.domElem.removeClass("active");if(!this.rte.selection.collapsed()||(g.nodeType==1&&/^(IMG|EMBED|OBJECT)$/.test(g.nodeName))){this.domElem.removeClass("disabled")}else{this.domElem.addClass("disabled")}}}};this.updatePopup=function(){var g=this.rte.dom.attr(this.link.get(0),"onclick");g=g?a.trim(g.toString()):"";if(g.length>0&&(m=g.match(/window.open\("([^"]+)",\s*"([^"]*)",\s*"([^"]*)"\s*.*\);\s*(return\s+false)?/))){this.src.popup.use.attr("checked","on");this.src.popup.url.val(m[1]);this.src.popup.name.val(m[2]);if(/location=yes/.test(m[3])){this.src.popup.location.attr("checked",true)}if(/menubar=yes/.test(m[3])){this.src.popup.menubar.attr("checked",true)}if(/toolbar=yes/.test(m[3])){this.src.popup.toolbar.attr("checked",true)}if(/scrollbars=yes/.test(m[3])){this.src.popup.scrollbars.attr("checked",true)}if(/status=yes/.test(m[3])){this.src.popup.status.attr("checked",true)}if(/resizable=yes/.test(m[3])){this.src.popup.resizable.attr("checked",true)}if(/dependent=yes/.test(m[3])){this.src.popup.dependent.attr("checked",true)}if((_m=m[3].match(/width=([^,]+)/))){this.src.popup.width.val(_m[1])}if((_m=m[3].match(/height=([^,]+)/))){this.src.popup.height.val(_m[1])}if((_m=m[3].match(/left=([^,]+)/))){this.src.popup.left.val(_m[1])}if((_m=m[3].match(/top=([^,]+)/))){this.src.popup.top.val(_m[1])}if(m[4]){this.src.popup.retfalse.attr("checked",true)}}else{a.each(this.src.popup,function(){var h=a(this);if(h.attr("type")=="text"){h.val(h.attr("name")=="url"?"http://":"")}else{if(h.attr("name")=="retfalse"){this.attr("checked",true)}else{h.removeAttr("checked")}}})}};this.updateOnclick=function(){var k=this.src.popup.url.val();if(this.src.popup.use.attr("checked")&&k){var o="";if(this.src.popup.location.attr("checked")){o+="location=yes,"}if(this.src.popup.menubar.attr("checked")){o+="menubar=yes,"}if(this.src.popup.toolbar.attr("checked")){o+="toolbar=yes,"}if(this.src.popup.scrollbars.attr("checked")){o+="scrollbars=yes,"}if(this.src.popup.status.attr("checked")){o+="status=yes,"}if(this.src.popup.resizable.attr("checked")){o+="resizable=yes,"}if(this.src.popup.dependent.attr("checked")){o+="dependent=yes,"}if(this.src.popup.width.val()){o+="width="+this.src.popup.width.val()+","}if(this.src.popup.height.val()){o+="height="+this.src.popup.height.val()+","}if(this.src.popup.left.val()){o+="left="+this.src.popup.left.val()+","}if(this.src.popup.top.val()){o+="top="+this.src.popup.top.val()+","}if(o.length>0){o=o.substring(0,o.length-1)}var h=this.src.popup.retfalse.attr("checked")?"return false;":"";var j='window.open("'+k+'", "'+a.trim(this.src.popup.name.val())+'", "'+o+'");'+h;this.src.events.onclick.val(j);if(!this.src.main.href.val()){this.src.main.href.val("#")}}else{var g=this.src.events.onclick.val();g=g.replace(/window\.open\([^\)]+\)\s*;?\s*return\s*false\s*;?/i,"");this.src.events.onclick.val(g)}};this.set=function(){this.updateOnclick();this.rte.browser.msie&&this.rte.selection.restoreIERange();this.rte.history.add();var h=this.rte.utils.absoluteURL(this.src.main.href.val());if(!h){this.link.parents().length&&this.rte.doc.execCommand("unlink",false,null)}else{if(!this.link.parents().length){var j="#--el-editor---"+Math.random();var o=this.rte.doc.execCommand("createLink",false,j);this.link=a('a[href="'+j+'"]',this.rte.doc);this.link.each(function(){var q=a(this);if(!a.trim(q.html())&&!a.trim(q.text())){q.replaceWith(q.text())}})}this.src.main.href.val(h);for(var k in this.src){if(k!="popup"){for(var p in this.src[k]){if(p!="anchors"){var g=a.trim(this.src[k][p].val());if(g){this.link.attr(p,g)}else{this.link.removeAttr(p)}}}}}}this.rte.ui.update(true)}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.nbsp=function(c,b){this.constructor.prototype.constructor.call(this,c,b);this.command=function(){this.rte.history.add();this.rte.selection.insertHtml("&nbsp;",true);this.rte.window.focus();this.rte.ui.update()};this.update=function(){this.domElem.removeClass("disabled")}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.outdent=function(d,c){this.constructor.prototype.constructor.call(this,d,c);var b=this;this.command=function(){var f=this.find();if(f.node){this.rte.history.add();a(f.node).css(f.type,(f.val>40?f.val-40:0)+"px");this.rte.ui.update()}};this.find=function(h){function f(o){var j={type:"",val:0};var k;if((k=b.rte.dom.attr(o,"style"))){j.type=k.indexOf("padding-left")!=-1?"padding-left":(k.indexOf("margin-left")!=-1?"margin-left":"");j.val=j.type?parseInt(a(o).css(j.type))||0:0}return j}var h=this.rte.selection.getNode();var g=f(h);if(g.val){g.node=h}else{a.each(this.rte.dom.parents(h,"*"),function(){g=f(this);if(g.val){g.node=this;return g}})}return g};this.update=function(){var f=this.find();if(f.node){this.domElem.removeClass("disabled")}else{this.domElem.addClass("disabled")}}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.pasteformattext=function(d,c){this.constructor.prototype.constructor.call(this,d,c);this.iframe=a(document.createElement("iframe")).addClass("el-rte-paste-input");this.doc=null;var b=this;this.command=function(){this.rte.browser.msie&&this.rte.selection.saveIERange();var f={submit:function(j,k){j.stopPropagation();j.preventDefault();b.paste();k.close()},dialog:{width:500,title:this.rte.i18n("Paste formatted text")}};var h=new elDialogForm(f);h.append(this.iframe).open();this.doc=this.iframe.get(0).contentWindow.document;html=this.rte.options.doctype+'<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';if(this.rte.options.cssfiles.length){a.each(this.rte.options.cssfiles,function(){html+='<link rel="stylesheet" type="text/css" href="'+this+'" />'})}html+="</head><body>  </body></html>";this.doc.open();this.doc.write(html);this.doc.close();if(!this.rte.browser.msie){try{this.doc.designMode="on"}catch(g){}}else{this.doc.body.contentEditable=true}this.iframe.get(0).contentWindow.focus()};this.paste=function(){var f=a.trim(a(this.doc.body).html());if(f){this.rte.history.add();this.rte.browser.msie&&this.rte.selection.restoreIERange();this.rte.selection.insertHtml(this.rte.filter(f),true);this.rte.ui.update(true)}};this.update=function(){this.domElem.removeClass("disabled")}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.pastetext=function(d,c){this.constructor.prototype.constructor.call(this,d,c);this.input=a("<textarea />").addClass("el-rte-paste-input");var b=this;this.command=function(){this.rte.browser.msie&&this.rte.selection.saveIERange();var f={submit:function(h,j){h.stopPropagation();h.preventDefault();b.paste();j.close()},dialog:{width:500,title:this.rte.i18n("Paste only text")}};var g=new elDialogForm(f);g.append(this.input).open()};this.paste=function(){var f=a.trim(this.input.val());if(f){this.rte.history.add();this.rte.browser.msie&&this.rte.selection.restoreIERange();this.rte.selection.insertText(f.replace(/\r?\n/g,"<br />"),true);this.rte.ui.update(true)}this.input.val("")};this.update=function(){this.domElem.removeClass("disabled")}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.save=function(c,b){this.constructor.prototype.constructor.call(this,c,b);this.active=true;this.command=function(){this.rte.save()};this.update=function(){}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.stopfloat=function(c,b){this.constructor.prototype.constructor.call(this,c,b);this.find=function(){if(this.rte.selection.collapsed()){var d=this.rte.dom.selfOrParent(this.rte.selection.getEnd(),/^DIV$/);if(d&&(this.rte.dom.attr(d,"clear")||a(d).css("clear")!="none")){return d}}};this.command=function(){var d;if((d=this.find())){var d=a(d);this.rte.history.add();if(!d.children().length&&!a.trim(d.text()).length){d.remove()}else{d.removeAttr("clear").css("clear","")}}else{this.rte.history.add();this.rte.selection.insertNode(a(this.rte.dom.create("div")).css("clear","both").get(0),true)}this.rte.ui.update(true)};this.update=function(){this.domElem.removeClass("disabled");if(this.find()){this.domElem.addClass("active")}else{this.domElem.removeClass("active")}}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.table=function(d,c){this.constructor.prototype.constructor.call(this,d,c);var b=this;this.src=null;this.labels=null;function f(){b.labels={main:"Properies",adv:"Advanced",events:"Events",id:"ID","class":"Css class",style:"Css style",dir:"Script direction",summary:"Summary",lang:"Language",href:"URL"};b.src={main:{caption:a('<input type="text" />'),rows:a('<input type="text" />').attr("size",5).val(2),cols:a('<input type="text" />').attr("size",5).val(2),width:a('<input type="text" />').attr("size",5),wunit:a("<select />").append(a("<option />").val("%").text("%")).append(a("<option />").val("px").text("px")),height:a('<input type="text" />').attr("size",5),hunit:a("<select />").append(a("<option />").val("%").text("%")).append(a("<option />").val("px").text("px")),align:a("<select />").append(a("<option />").val("").text(b.rte.i18n("Not set"))).append(a("<option />").val("left").text(b.rte.i18n("Left"))).append(a("<option />").val("center").text(b.rte.i18n("Center"))).append(a("<option />").val("right").text(b.rte.i18n("Right"))),spacing:a('<input type="text" />').attr("size",5),padding:a('<input type="text" />').attr("size",5),border:a("<div />"),rules:a("<select />").append(a("<option />").val("none").text(b.rte.i18n("No"))).append(a("<option />").val("all").text(b.rte.i18n("Cells"))).append(a("<option />").val("groups").text(b.rte.i18n("Groups"))).append(a("<option />").val("rows").text(b.rte.i18n("Rows"))).append(a("<option />").val("cols").text(b.rte.i18n("Columns"))),margin:a("<div />"),bg:a("<div />"),bgimg:a('<input type="text" />').css("width","90%")},adv:{id:a('<input type="text" />'),summary:a('<input type="text" />'),"class":a('<input type="text" />'),style:a('<input type="text" />'),dir:a("<select />").append(a("<option />").text(b.rte.i18n("Not set")).val("")).append(a("<option />").text(b.rte.i18n("Left to right")).val("ltr")).append(a("<option />").text(b.rte.i18n("Right to left")).val("rtl")),lang:a('<input type="text" />')},events:{}};a.each(b.src,function(){for(var h in this){this[h].attr("name",h);var g=this[h].get(0).nodeName;if(g=="INPUT"&&h!="bgimg"){this[h].css(this[h].attr("size")?{"text-align":"right"}:{width:"100%"})}else{if(g=="SELECT"&&h!="wunit"&&h!="hunit"){this[h].css("width","100%")}}}});a.each(["onblur","onfocus","onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmouseout","onmouseleave","onkeydown","onkeypress","onkeyup"],function(){b.src.events[this]=a('<input type="text" />').attr("name",this).css("width","100%")});b.src.main.align.change(function(){var h=a(this).val();if(h=="center"){b.src.main.margin.val({left:"auto",right:"auto"})}else{var g=b.src.main.margin.val();if(g.left=="auto"&&g.right=="auto"){b.src.main.margin.val({left:"",right:""})}}});b.src.main.bgimg.change(function(){var g=a(this);g.val(b.rte.utils.absoluteURL(g.val()))})}this.command=function(){var q=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^TABLE$/);if(this.name=="table"){this.table=a(this.rte.doc.createElement("table"))}else{this.table=q?a(q):a(this.rte.doc.createElement("table"))}!this.src&&f();this.src.main.border.elBorderSelect({styleHeight:117});this.src.main.bg.elColorPicker({palettePosition:"outer","class":"el-colorpicker ui-icon ui-icon-pencil"});this.src.main.margin.elPaddingInput({type:"margin",value:this.table});if(this.table.parents().length){this.src.main.rows.val("").attr("disabled",true);this.src.main.cols.val("").attr("disabled",true)}else{this.src.main.rows.val(2).removeAttr("disabled");this.src.main.cols.val(2).removeAttr("disabled")}var C=this.table.css("width")||this.table.attr("width");this.src.main.width.val(parseInt(C)||"");this.src.main.wunit.val(C.indexOf("px")!=-1?"px":"%");var x=this.table.css("height")||this.table.attr("height");this.src.main.height.val(parseInt(x)||"");this.src.main.hunit.val(x&&x.indexOf("px")!=-1?"px":"%");var A=this.table.css("float");this.src.main.align.val("");if(A=="left"||A=="right"){this.src.main.align.val(A)}else{var r=this.table.css("margin-left");var o=this.table.css("margin-right");if(r=="auto"&&o=="auto"){this.src.main.align.val("center")}}this.src.main.border.val(this.table);this.src.main.rules.val(this.rte.dom.attr(this.table.get(0),"rules"));this.src.main.bg.val(this.table.css("background-color"));var g=this.table.css("background-image").replace(/url\(([^\)]+)\)/i,"$1");this.src.main.bgimg.val(g!="none"?g:"");var j={submit:function(h,v){h.stopPropagation();h.preventDefault();b.set();v.close()},dialog:{width:530,title:this.rte.i18n("Table")}};var B=new elDialogForm(j);for(var p in this.src){B.tab(p,this.rte.i18n(this.labels[p]));if(p=="main"){var z=a("<table />").append(a("<tr />").append("<td>"+this.rte.i18n("Rows")+"</td>").append(a("<td />").append(this.src.main.rows))).append(a("<tr />").append("<td>"+this.rte.i18n("Columns")+"</td>").append(a("<td />").append(this.src.main.cols)));var u=a("<table />").append(a("<tr />").append("<td>"+this.rte.i18n("Width")+"</td>").append(a("<td />").append(this.src.main.width).append(this.src.main.wunit))).append(a("<tr />").append("<td>"+this.rte.i18n("Height")+"</td>").append(a("<td />").append(this.src.main.height).append(this.src.main.hunit)));var t=a("<table />").append(a("<tr />").append("<td>"+this.rte.i18n("Spacing")+"</td>").append(a("<td />").append(this.src.main.spacing.val(this.table.attr("cellspacing")||"")))).append(a("<tr />").append("<td>"+this.rte.i18n("Padding")+"</td>").append(a("<td />").append(this.src.main.padding.val(this.table.attr("cellpadding")||""))));B.append([this.rte.i18n("Caption"),this.src.main.caption.val(this.table.find("caption").eq(0).text()||"")],"main",true).separator("main").append([z,u,t],"main",true).separator("main").append([this.rte.i18n("Border"),this.src.main.border],"main",true).append([this.rte.i18n("Inner borders"),this.src.main.rules],"main",true).append([this.rte.i18n("Alignment"),this.src.main.align],"main",true).append([this.rte.i18n("Margins"),this.src.main.margin],"main",true).append([this.rte.i18n("Background"),a("<span />").append(a("<span />").css({"float":"left","margin-right":"3px"}).append(this.src.main.bg)).append(this.src.main.bgimg)],"main",true)}else{for(var k in this.src[p]){var D=this.rte.dom.attr(this.table,k);if(p=="events"){D=this.rte.utils.trimEventCallback(D)}B.append([this.rte.i18n(this.labels[k]?this.labels[k]:k),this.src[p][k].val(D)],p,true)}}}B.open()};this.set=function(){if(!this.table.parents().length){var g=parseInt(this.src.main.rows.val())||0;var x=parseInt(this.src.main.cols.val())||0;if(g<=0||x<=0){return}this.rte.history.add();var A=a(this.rte.doc.createElement("tbody")).appendTo(this.table);var z=a("<tr />");for(var p=0;p<x;p++){z.append(a("<td />").html("&nbsp;"))}for(var p=0;p<g;p++){A.append(z.clone(true))}this.rte.selection.insertNode(this.table.get(0),true)}else{this.table.removeAttr("width").removeAttr("height").removeAttr("border").removeAttr("align").removeAttr("bordercolor").removeAttr("bgcolor").removeAttr("cellspacing").removeAttr("cellpadding").removeAttr("frame").removeAttr("rules").removeAttr("style")}var F=a.trim(this.src.main.caption.val());if(F){if(!this.table.children("caption").length){this.table.prepend(a("<caption />"))}this.table.children("caption").text(F)}else{this.table.children("caption").remove()}for(var k in this.src){if(k!="main"){for(var j in this.src[k]){var D=a.trim(this.src[k][j].val());if(D){this.table.attr(j,D)}else{this.table.removeAttr(j)}}}}var u,B,E;if((u=parseInt(this.src.main.spacing.val()))&&u>=0){this.table.attr("cellspacing",u)}if((B=parseInt(this.src.main.padding.val()))&&B>=0){this.table.attr("cellpadding",B)}if((E=this.src.main.rules.val())){this.table.attr("rules",E)}var C=parseInt(this.src.main.width.val())||"",q=parseInt(this.src.main.height.val())||"",p=a.trim(this.src.main.bgimg.val()),A=this.src.main.border.val(),o=this.src.main.margin.val(),t=this.src.main.align.val();this.table.css({width:C?C+this.src.main.wunit.val():"",height:q?q+this.src.main.hunit.val():"",border:a.trim(A.width+" "+A.style+" "+A.color),"background-color":this.src.main.bg.val(),"background-image":p?"url("+p+")":""});if(o.css){this.table.css("margin",o.css)}else{this.table.css({"margin-top":o.top,"margin-right":o.right,"margin-bottom":o.bottom,"margin-left":o.left})}if((t=="left"||t=="right")&&this.table.css("margin-left")!="auto"&&this.table.css("margin-right")!="auto"){this.table.css("float",t)}if(!this.table.attr("style")){this.table.removeAttr("style")}this.rte.ui.update()};this.update=function(){this.domElem.removeClass("disabled");if(this.name=="tableprops"&&!this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^TABLE$/)){this.domElem.addClass("disabled").removeClass("active")}}};elRTE.prototype.ui.prototype.buttons.tableprops=elRTE.prototype.ui.prototype.buttons.table})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.tablerm=function(c,b){this.constructor.prototype.constructor.call(this,c,b);this.command=function(){var d=this.rte.dom.parent(this.rte.selection.getNode(),/^TABLE$/);if(d){this.rte.history.add();a(d).remove()}this.rte.ui.update(true)};this.update=function(){if(this.rte.dom.parent(this.rte.selection.getNode(),/^TABLE$/)){this.domElem.removeClass("disabled")}else{this.domElem.addClass("disabled")}}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.tbcellprops=function(d,c){this.constructor.prototype.constructor.call(this,d,c);var b=this;this.src=null;this.labels=null;function f(){b.labels={main:"Properies",adv:"Advanced",events:"Events",id:"ID","class":"Css class",style:"Css style",dir:"Script direction",lang:"Language"};b.src={main:{type:a("<select />").css("width","100%").append(a("<option />").val("td").text(b.rte.i18n("Data"))).append(a("<option />").val("th").text(b.rte.i18n("Header"))),width:a('<input type="text" />').attr("size",4),wunit:a("<select />").append(a("<option />").val("%").text("%")).append(a("<option />").val("px").text("px")),height:a('<input type="text" />').attr("size",4),hunit:a("<select />").append(a("<option />").val("%").text("%")).append(a("<option />").val("px").text("px")),align:a("<select />").css("width","100%").append(a("<option />").val("").text(b.rte.i18n("Not set"))).append(a("<option />").val("left").text(b.rte.i18n("Left"))).append(a("<option />").val("center").text(b.rte.i18n("Center"))).append(a("<option />").val("right").text(b.rte.i18n("Right"))).append(a("<option />").val("justify").text(b.rte.i18n("Justify"))),border:a("<div />"),padding:a("<div />"),bg:a("<div />"),bgimg:a('<input type="text" />').css("width","90%"),apply:a("<select />").css("width","100%").append(a("<option />").val("").text(b.rte.i18n("Current cell"))).append(a("<option />").val("row").text(b.rte.i18n("All cells in row"))).append(a("<option />").val("column").text(b.rte.i18n("All cells in column"))).append(a("<option />").val("table").text(b.rte.i18n("All cells in table")))},adv:{id:a('<input type="text" />'),"class":a('<input type="text" />'),style:a('<input type="text" />'),dir:a("<select />").css("width","100%").append(a("<option />").text(b.rte.i18n("Not set")).val("")).append(a("<option />").text(b.rte.i18n("Left to right")).val("ltr")).append(a("<option />").text(b.rte.i18n("Right to left")).val("rtl")),lang:a('<input type="text" />')},events:{}};a.each(b.src,function(){for(var g in this){this[g].attr("name",g);if(this[g].attr("type")=="text"&&!this[g].attr("size")&&g!="bgimg"){this[g].css("width","100%")}}});a.each(["onblur","onfocus","onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmouseout","onmouseleave","onkeydown","onkeypress","onkeyup"],function(){b.src.events[this]=a('<input type="text" />').attr("name",this).css("width","100%")})}this.command=function(){!this.src&&f();this.cell=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/);if(!this.cell){return}this.src.main.type.val(this.cell.nodeName.toLowerCase());this.cell=a(this.cell);this.src.main.border.elBorderSelect({styleHeight:117,value:this.cell});this.src.main.bg.elColorPicker({palettePosition:"outer","class":"el-colorpicker ui-icon ui-icon-pencil"});this.src.main.padding.elPaddingInput({value:this.cell});var g=this.cell.css("width")||this.cell.attr("width");this.src.main.width.val(parseInt(g)||"");this.src.main.wunit.val(g.indexOf("px")!=-1?"px":"%");var p=this.cell.css("height")||this.cell.attr("height");this.src.main.height.val(parseInt(p)||"");this.src.main.hunit.val(p.indexOf("px")!=-1?"px":"%");this.src.main.align.val(this.cell.attr("align")||this.cell.css("text-align"));this.src.main.bg.val(this.cell.css("background-color"));var r=this.cell.css("background-image");this.src.main.bgimg.val(r&&r!="none"?r.replace(/url\(([^\)]+)\)/i,"$1"):"");this.src.main.apply.val("");var q={submit:function(h,u){h.stopPropagation();h.preventDefault();b.set();u.close()},dialog:{width:"auto",title:this.rte.i18n("Table cell properties")}};var t=new elDialogForm(q);for(var o in this.src){t.tab(o,this.rte.i18n(this.labels[o]));if(o=="main"){t.append([this.rte.i18n("Width"),a("<span />").append(this.src.main.width).append(this.src.main.wunit)],"main",true).append([this.rte.i18n("Height"),a("<span />").append(this.src.main.height).append(this.src.main.hunit)],"main",true).append([this.rte.i18n("Table cell type"),this.src.main.type],"main",true).append([this.rte.i18n("Border"),this.src.main.border],"main",true).append([this.rte.i18n("Alignment"),this.src.main.align],"main",true).append([this.rte.i18n("Paddings"),this.src.main.padding],"main",true).append([this.rte.i18n("Background"),a("<span />").append(a("<span />").css({"float":"left","margin-right":"3px"}).append(this.src.main.bg)).append(this.src.main.bgimg)],"main",true).append([this.rte.i18n("Apply to"),this.src.main.apply],"main",true)}else{for(var k in this.src[o]){var j=this.cell.attr(k)||"";if(o=="events"){j=this.rte.utils.trimEventCallback(j)}t.append([this.rte.i18n(this.labels[k]?this.labels[k]:k),this.src[o][k].val(j)],o,true)}}}t.open()};this.set=function(){a(C).remove();var u=this.cell,A=this.src.main.apply.val();switch(this.src.main.apply.val()){case"row":u=this.cell.parent("tr").children("td,th");break;case"column":u=a(this.rte.dom.tableColumn(this.cell.get(0)));break;case"table":u=this.cell.parents("table").find("td,th");break}for(var k in this.src){if(k!="main"){for(var j in this.src[k]){var B=a.trim(this.src[k][j].val());if(B){u.attr(j,B)}else{u.removeAttr(j)}}}}u.removeAttr("width").removeAttr("height").removeAttr("border").removeAttr("align").removeAttr("bordercolor").removeAttr("bgcolor");var C=this.src.main.type.val();var z=parseInt(this.src.main.width.val())||"";var q=parseInt(this.src.main.height.val())||"";var o=a.trim(this.src.main.bgimg.val());var x=this.src.main.border.val();var r={width:z?z+this.src.main.wunit.val():"",height:q?q+this.src.main.hunit.val():"","background-color":this.src.main.bg.val(),"background-image":o?"url("+o+")":"",border:a.trim(x.width+" "+x.style+" "+x.color),"text-align":this.src.main.align.val()||""};var g=this.src.main.padding.val();if(g.css){r.padding=g.css}else{r["padding-top"]=g.top;r["padding-right"]=g.right;r["padding-bottom"]=g.bottom;r["padding-left"]=g.left}u=u.get();a.each(u,function(){var w=this.nodeName.toLowerCase();var E=a(this);if(w!=C){var h={};for(var t in b.src.adv){var p=E.attr(t);if(p){h[t]=p.toString()}}for(var t in b.src.events){var p=E.attr(t);if(p){h[t]=p.toString()}}var F=E.attr("colspan")||1;var D=E.attr("rowspan")||1;if(F>1){h.colspan=F}if(D>1){h.rowspan=D}E.replaceWith(a("<"+C+" />").html(E.html()).attr(h).css(r))}else{E.css(r)}});this.rte.ui.update()};this.update=function(){if(this.rte.dom.parent(this.rte.selection.getNode(),/^TABLE$/)){this.domElem.removeClass("disabled")}else{this.domElem.addClass("disabled")}}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.tbcellsmerge=function(f,d){this.constructor.prototype.constructor.call(this,f,d);var c=this;function b(){var h=c.rte.dom.selfOrParent(c.rte.selection.getStart(),/^(TD|TH)$/);var g=c.rte.dom.selfOrParent(c.rte.selection.getEnd(),/^(TD|TH)$/);if(h&&g&&h!=g&&a(h).parents("table").get(0)==a(g).parents("table").get(0)){return[h,g]}return null}this.command=function(){var x=b();if(x){var w=this.rte.dom.indexOf(a(x[0]).parent("tr").get(0));var q=this.rte.dom.indexOf(a(x[1]).parent("tr").get(0));var p=Math.min(w,q);var t=Math.max(w,q)-p+1;var h=this.rte.dom.tableColumn(x[0],true,true);var g=this.rte.dom.tableColumn(x[1],true);var A=a.inArray(x[0],h.column);var v=a.inArray(x[1],g.column);var o=h.info.offset[A]<g.info.offset[v]?h:g;var u=h.info.offset[A]>=g.info.offset[v]?h:g;var j=0;var r=null;var k="";this.rte.history.add();var z=a(a(x[0]).parents("table").eq(0).find("tr").get().slice(p,p+t)).each(function(D){var C=k.length;var B=false;a(this).children("td,th").each(function(){var J=a(this);var H=a.inArray(this,o.column);var G=a.inArray(this,u.column);if(H!=-1||G!=-1){B=H!=-1&&G==-1;var F=parseInt(J.attr("colspan")||1);if(D==0){j+=F}if(H!=-1&&D>0){var K=o.info.delta[H];if(K>0){if(J.css("text-align")=="left"){var E=J.clone(true);J.html("&nbsp;")}else{var E=J.clone().html("&nbsp;")}E.removeAttr("colspan").removeAttr("id").insertBefore(this);if(K>1){E.attr("colspan",K)}}}if(G!=-1){var K=u.info.delta[G];if(F-K>1){var I=F-K-1;if(J.css("text-align")=="right"){var E=J.clone(true);J.html("&nbsp;")}else{var E=J.clone().html("&nbsp;")}E.removeAttr("colspan").removeAttr("id").insertAfter(this);if(I>1){E.attr("colspan",I)}}}if(!r){r=J}else{k+=J.html();J.remove()}}else{if(B){if(D==0){j+=parseInt(J.attr("colspan")||1)}k+=J.html();J.remove()}}});k+=C!=k.length?"<br />":""});r.removeAttr("colspan").removeAttr("rowspan").html(r.html()+k);if(j>1){r.attr("colspan",j)}if(t>1){r.attr("rowspan",t)}this.rte.dom.fixTable(a(x[0]).parents("table").get(0))}};this.update=function(){if(b()){this.domElem.removeClass("disabled")}else{this.domElem.addClass("disabled")}}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.tbcellsplit=function(c,b){this.constructor.prototype.constructor.call(this,c,b);this.command=function(){var h=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/);if(h){this.rte.history.add();var j=parseInt(this.rte.dom.attr(h,"colspan"));var k=parseInt(this.rte.dom.attr(h,"rowspan"));if(j>1||k>1){var t=j-1;var u=k-1;var p=this.rte.dom.parent(h,/^TABLE$/);var o=this.rte.dom.tableMatrix(p);if(t){for(var q=0;q<t;q++){a(this.rte.dom.create(h.nodeName)).html("&nbsp;").insertAfter(h)}}if(u){var w=this.rte.dom.indexesOfCell(h,o);var g=w[0];var f=w[1];for(var d=g+1;d<g+u+1;d++){var v;if(!o[d][f].nodeName){if(o[d][f-1].nodeName){v=o[d][f-1]}else{for(var q=f-1;q>=0;q--){if(o[d][q].nodeName){v=o[d][q];break}}}if(v){for(var q=0;q<=t;q++){a(this.rte.dom.create(v.nodeName)).html("&nbsp;").insertAfter(v)}}}}}a(h).removeAttr("colspan").removeAttr("rowspan");this.rte.dom.fixTable(p)}}this.rte.ui.update(true)};this.update=function(){var d=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/);if(d&&(parseInt(this.rte.dom.attr(d,"colspan"))>1||parseInt(this.rte.dom.attr(d,"rowspan"))>1)){this.domElem.removeClass("disabled")}else{this.domElem.addClass("disabled")}}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.tbcolbefore=function(d,c){this.constructor.prototype.constructor.call(this,d,c);var b=this;this.command=function(){var f=this.rte.dom.tableColumn(this.rte.selection.getNode(),false,true);if(f.length){this.rte.history.add();a.each(f,function(){var h=a(this);var g=parseInt(h.attr("colspan")||1);if(g>1){h.attr("colspan",g+1)}else{var j=h.clone().html("&nbsp;").removeAttr("colspan").removeAttr("width").removeAttr("id");if(b.name=="tbcolbefore"){j.insertBefore(this)}else{j.insertAfter(this)}}});this.rte.ui.update()}};this.update=function(){if(this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/)){this.domElem.removeClass("disabled")}else{this.domElem.addClass("disabled")}}};elRTE.prototype.ui.prototype.buttons.tbcolafter=elRTE.prototype.ui.prototype.buttons.tbcolbefore})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.tbcolrm=function(d,c){this.constructor.prototype.constructor.call(this,d,c);var b=this;this.command=function(){var o=this.rte.selection.getNode();var k=this.rte.dom.selfOrParent(o,/^(TD|TH)$/);var j=a(k).prev("td,th").get(0);var h=a(k).next("td,th").get(0);var f=this.rte.dom.parent(o,/^TABLE$/);var g=this.rte.dom.tableColumn(o,false,true);if(g.length){this.rte.history.add();a.each(g,function(){var q=a(this);var p=parseInt(q.attr("colspan")||1);if(p>1){q.attr("colspan",p-1)}else{q.remove()}});this.rte.dom.fixTable(f);if(j||h){this.rte.selection.selectContents(j?j:h).collapse(true)}this.rte.ui.update(true)}};this.update=function(){if(this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/)){this.domElem.removeClass("disabled")}else{this.domElem.addClass("disabled")}}}})(jQuery);elRTE.prototype.ui.prototype.buttons.tbrowbefore=function(b,a){this.constructor.prototype.constructor.call(this,b,a);this.command=function(){var g=this.rte.selection.getNode();var q=this.rte.dom.selfOrParent(g,/^(TD|TH)$/);var d=this.rte.dom.selfOrParent(q,/^TR$/);var v=this.rte.dom.tableMatrix(this.rte.dom.selfOrParent(q,/^TABLE$/));if(q&&d&&v){this.rte.history.add();var t=this.name=="tbrowbefore";var p=$(d).prevAll("tr").length;var h=0;var o=[];function j(c,r){while(r>0){r--;if(v[r]&&v[r][c]&&v[r][c].nodeName){return v[r][c]}}}for(var k=0;k<v[p].length;k++){if(v[p][k]&&v[p][k].nodeName){var u=$(v[p][k]);var f=parseInt(u.attr("colspan")||1);if(parseInt(u.attr("rowspan")||1)>1){if(t){h+=f}else{o.push(u)}}else{h+=f}}else{if(v[p][k]=="-"){u=j(k,p);u&&o.push($(u))}}}var w=$("<tr />");for(var k=0;k<h;k++){w.append("<td>&nbsp;</td>")}if(t){w.insertBefore(d)}else{w.insertAfter(d)}$.each(o,function(){$(this).attr("rowspan",parseInt($(this).attr("rowspan")||1)+1)});this.rte.ui.update()}};this.update=function(){if(this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^TR$/)){this.domElem.removeClass("disabled")}else{this.domElem.addClass("disabled")}}};elRTE.prototype.ui.prototype.buttons.tbrowafter=elRTE.prototype.ui.prototype.buttons.tbrowbefore;(function(a){elRTE.prototype.ui.prototype.buttons.tbrowrm=function(d,c){this.constructor.prototype.constructor.call(this,d,c);var b=this;this.command=function(){var g=this.rte.selection.getNode(),w=this.rte.dom.selfOrParent(g,/^(TD|TH)$/),f=this.rte.dom.selfOrParent(w,/^TR$/),p=this.rte.dom.selfOrParent(w,/^TABLE$/),z=this.rte.dom.tableMatrix(p);if(w&&f&&z.length){this.rte.history.add();if(z.length==1){a(p).remove();return this.rte.ui.update()}var t=[];var u=a(f).prevAll("tr").length;function o(r,B){while(B>0){B--;if(z[B]&&z[B][r]&&z[B][r].nodeName){return z[B][r]}}}function A(B,r){y=u+1;var D=null;if(z[y]){for(var C=0;C<r;C++){if(z[y][C]&&z[y][C].nodeName){D=z[y][C]}}B=B.remove();if(D){B.insertAfter(D)}else{B.prependTo(a(f).next("tr").eq(0))}}}function k(B){for(var r=0;r<B.length;r++){if(B[r]==w){return r<B.length-1?B[r+1]:B[r-1]}}}for(var q=0;q<z[u].length;q++){var x=null;var h=false;if(z[u][q]&&z[u][q].nodeName){x=z[u][q];h=true}else{if(z[u][q]=="-"&&(x=o(q,u))){h=false}}if(x){x=a(x);var j=parseInt(x.attr("rowspan")||1);if(j>1){x.attr("rowspan",j-1);h&&A(x,q,u)}}}var v=k(this.rte.dom.tableColumn(w));if(v){this.rte.selection.selectContents(v).collapse(true)}a(f).remove()}this.rte.ui.update()};this.update=function(){if(this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^TR$/)){this.domElem.removeClass("disabled")}else{this.domElem.addClass("disabled")}}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.undo=function(c,b){this.constructor.prototype.constructor.call(this,c,b);this.command=function(){if(this.name=="undo"&&this.rte.history.canBack()){this.rte.history.back();this.rte.ui.update()}else{if(this.name=="redo"&&this.rte.history.canFwd()){this.rte.history.fwd();this.rte.ui.update()}}};this.update=function(){this.domElem.toggleClass("disabled",this.name=="undo"?!this.rte.history.canBack():!this.rte.history.canFwd())}};elRTE.prototype.ui.prototype.buttons.redo=elRTE.prototype.ui.prototype.buttons.undo})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.unlink=function(c,b){this.constructor.prototype.constructor.call(this,c,b);this.command=function(){var g=this.rte.selection.getNode();var d,f;if((d=this.rte.dom.selfOrParentLink(g))){f=d}else{if((d=this.rte.dom.childLinks(g))){f=d[0]}}if(f){this.rte.history.add();this.rte.selection.select(f);this.rte.doc.execCommand("unlink",false,null);this.rte.ui.update(true)}};this.update=function(){var d=this.rte.selection.getNode();if(this.rte.dom.selfOrParentLink(d)||this.rte.dom.childLinks(d).length){this.domElem.removeClass("disabled").addClass("active")}else{this.domElem.removeClass("active").addClass("disabled")}}}})(jQuery);